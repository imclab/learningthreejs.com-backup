<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title>Learning Three.js</title>
  <link href="http://learningthreejs.com/atom.xml" rel="self"/>
  <link href="http://learningthreejs.com/"/>
  <updated>2012-01-21T10:36:43+01:00</updated>
  <id>http://learningthreejs.com/</id>
  <author>
    <name>Jerome Etienne</name>
    
  </author>

  
  <entry>
    <title>Boilerplate Builder for Three.js</title>
    <link href="http://learningthreejs.com/blog/2012/01/19/boilerplate-builder-for-three-js/"/>
    <updated>2012-01-19T10:59:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2012/01/19/boilerplate-builder-for-three-js</id>
    <content type="html">&lt;p&gt;We recently introduced a
&lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate&quot;&gt;boilerplate for three.js&lt;/a&gt;
in a
&lt;a href=&quot;http://learningthreejs.com/blog/2011/12/20/boilerplate-for-three-js/&quot;&gt;previous post&lt;/a&gt;.
It aims to ease your first contact with
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;.
It contains a template for a simple project,
a sample on which we already applied good practices.
You download it and run it in a matter of minutes.
Thus you can immediatly focus on your own things.
In short, it aims for &lt;em&gt;Fast bootstrap + Good Practices&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;It seems nice, hey ?
Well there is a glitch.
The
&lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate&quot;&gt;boilerplate for three.js&lt;/a&gt;
needs more flexibily.
In a way, it acts as a ground on top of which you start your own thing.
We do our best to provide good defaults, but they are only defaults.
What if you got specific requirements ?
How to start your project then ?
The
&lt;a href=&quot;http://jeromeetienne.github.com/threejsboilerplatebuilder/&quot;&gt;boilerplate builder&lt;/a&gt;
has been written for you :)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://jeromeetienne.github.com/threejsboilerplatebuilder/&quot;&gt;Try it out&lt;/a&gt;.
Go ahead, play with the options,
discover what they do and customize your own boilerplate.
The
&lt;a href=&quot;http://www.youtube.com/watch?v=ANnPWZGRsGk&quot;&gt;screencast&lt;/a&gt;
below is short introduction where i describe the
&lt;a href=&quot;http://jeromeetienne.github.com/threejsboilerplatebuilder/&quot;&gt;boilerplate builder&lt;/a&gt;.&lt;/p&gt;

&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/ANnPWZGRsGk?hl=en&amp;fs=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;




&lt;!-- more --&gt;


&lt;h2&gt;Making-Of the Builder&lt;/h2&gt;

&lt;p&gt;The
&lt;a href=&quot;http://jeromeetienne.github.com/threejsboilerplatebuilder/&quot;&gt;builder&lt;/a&gt;
itself was interesting to build.
It uses various nice features from the current web.
It is a pure-browser webapp with a file download,
a preview of a webgl project
and a nice looking visual appearance.&lt;/p&gt;

&lt;h3&gt;Pure Browser Download&lt;/h3&gt;

&lt;p&gt;I like to write pure-browser application.
They dont require a server to run, only static files.
It makes it much easier to host your application.
So
&lt;a href=&quot;http://jeromeetienne.github.com/threejsboilerplatebuilder/&quot;&gt;boilerplate builder&lt;/a&gt;
has been written as a pure-browser application :)
It uses
&lt;a href=&quot;http://jszip.stuartk.co.uk/&quot;&gt;jszip&lt;/a&gt;
, a library which create .zip files with Javascript.
Its creates the boilerplater.zip that you download.
Additionally, it uses
&lt;a href=&quot;https://github.com/dcneiner/Downloadify&quot;&gt;downloadify&lt;/a&gt;
, a small library to create and download files without server.&lt;/p&gt;

&lt;p&gt;Together,
&lt;a href=&quot;http://jszip.stuartk.co.uk/&quot;&gt;jszip&lt;/a&gt;
and
&lt;a href=&quot;https://github.com/dcneiner/Downloadify&quot;&gt;downloadify&lt;/a&gt;
makes it easy to pack several files together,
and allow the user to download it.
All that in pure-browser, neat no?
I love what the web is becoming!&lt;/p&gt;

&lt;h3&gt;Boilerplate Preview&lt;/h3&gt;

&lt;p&gt;The preview is a bit different.
We start to load the &lt;em&gt;index.html&lt;/em&gt; template for the boilerplate.
We apply all the options you configured and produce the final version.
To actually preview this file, we encode it in
&lt;a href=&quot;http://en.wikipedia.org/wiki/Base64&quot;&gt;base64&lt;/a&gt;
to build a
&lt;a href=&quot;http://en.wikipedia.org/wiki/Data_URI_scheme&quot;&gt;data url&lt;/a&gt;
with it.
Only then, we create an iframe with this data uri
and you can see the webgl preview :)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Data_URI_scheme&quot;&gt;Data url&lt;/a&gt;
is a new HTML5 feature.
It allows to encode data directly in the URL.
It may be used to include image directly in css for examples.
Very usefull but not for human consumption.
To give you an idea, here is &lt;a href=&quot;http://pastebin.com/yF3XDSFW&quot;&gt;index.html&lt;/a&gt; in as data url.
It looks like long ugly random string.&lt;/p&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;data:text/html;base64,PCFkb2N0eXBlIGh0....
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h3&gt;Visual Appearance&lt;/h3&gt;

&lt;p&gt;It includes
&lt;a href=&quot;http://twitter.github.com/bootstrap/&quot;&gt;twitter bootstrap&lt;/a&gt; for css.
I am quite grateful for this framework.
Without it, the
&lt;a href=&quot;http://jeromeetienne.github.com/threejsboilerplatebuilder/&quot;&gt;builder page&lt;/a&gt;
will be so ugly, that people run away without even trying the application itself.
&lt;a href=&quot;http://twitter.github.com/bootstrap/&quot;&gt;twitter bootstrap&lt;/a&gt;
makes it so easy to write a webapp which looks good on the screen.
I think all the css-impaired of the world should thanks twitter for this framework :)&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;It has been quite fun to write it.
I learned some web skills,
discovered new part of three.js,
and on top of that, it looks good on screen.
I could not ask for more.
The goal of
&lt;a href=&quot;http://jeromeetienne.github.com/threejsboilerplatebuilder/&quot;&gt;boilerplate builder for three.js&lt;/a&gt;
is to add more &lt;em&gt;flexibility&lt;/em&gt; to the &lt;em&gt;fast bootstrap + good practices&lt;/em&gt; from the
&lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate&quot;&gt;boilerplate&lt;/a&gt;.
I hope it will help people starting lots of new
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;
projects :)&lt;/p&gt;

&lt;p&gt;That's all folks.
Have fun.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Dom Events in 3D Space</title>
    <link href="http://learningthreejs.com/blog/2012/01/17/dom-events-in-3d-space/"/>
    <updated>2012-01-17T11:56:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2012/01/17/dom-events-in-3d-space</id>
    <content type="html">&lt;p&gt;Ever dreamed of a &lt;strong&gt;object3d.on('click', function(){ ... });&lt;/strong&gt;?&lt;/p&gt;

&lt;p&gt;I have :) This post presents a little experiment.
What about implementing the concept of
&lt;a href=&quot;http://www.w3.org/TR/DOM-Level-2-Events/events.html&quot;&gt;dom events&lt;/a&gt;
in 3D Space.
In a web page, a
&lt;a href=&quot;http://www.quirksmode.org/dom/events/click.html&quot;&gt;click&lt;/a&gt;
event is trigger when a user click on a
&lt;a href=&quot;http://en.wikipedia.org/wiki/HTML_element&quot;&gt;element&lt;/a&gt;.
This is common knowledge in web development.
What about having that but in a three.js scene ?
Maybe people will start do 3D user interface with that, who knows.
How great would that be ?!?
So let's do that.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://jeromeetienne.github.com/threex/examples/threex.domevent/&quot;&gt;Try it out&lt;/a&gt;.
The demo contains 3 teapots.
Each bind a different type of events.
When the events are triggered, teapots are animated.
Animations are made by &lt;a href=&quot;https://github.com/sole/tween.js/&quot;&gt;tween.js&lt;/a&gt;, a nice js tweening engine
seen in a &lt;a href=&quot;http://learningthreejs.com/blog/2011/08/17/tweenjs-for-smooth-animation/&quot;&gt;previous post&lt;/a&gt;.
Play with it to get a feel of it, maybe think about the type of UI you could do in 3D.&lt;/p&gt;

&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/c2KLj8sie9Q?hl=en&amp;fs=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;


&lt;h2&gt;Let's Get Started&lt;/h2&gt;

&lt;p&gt;First let's include the source.
You download &lt;a href=&quot;https://github.com/jeromeetienne/threex/blob/master/threex.domevent.js&quot;&gt;threex.domevent.js&lt;/a&gt;.
and copy this line in your page.&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src='threex.domevent.js'&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;Let's Use It&lt;/h2&gt;

&lt;iframe src=&quot;http://jeromeetienne.github.com/threex/examples/threex.domevent&quot;
    webkitallowfullscreen mozallowfullscreen allowfullscreen 
    width=&quot;420&quot; height=&quot;315&quot; frameborder=&quot;0&quot; style=&quot;float: right; margin-left: 1em;&quot;&gt;
&lt;/iframe&gt;


&lt;p&gt;Let's say we want do to an action when the user is clicking on a object.
We just do the following.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mesh.on('click', function()({
    mesh.scale.x *= 2;
}))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;This short line means &quot;&lt;em&gt;if the user click on this mesh, make it twice wider&lt;/em&gt;&quot;.
Eloquent meaning, short syntax ... pretty sweet in my book.
If you wish to stop listening just do as usual.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mesh.off('click', callback)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;In fact, there is 2 naming for those functions:
one is
&lt;a href=&quot;https://developer.mozilla.org/en/DOM/element.addEventListener&quot;&gt;addEventListener&lt;/a&gt;
/
&lt;a href=&quot;https://developer.mozilla.org/en/DOM/element.removeEventListener&quot;&gt;removeEventListener&lt;/a&gt;
from
&lt;a href=&quot;http://www.whatwg.org/specs/web-apps/current-work/multipage/semantics.html&quot;&gt;HTMLElement&lt;/a&gt;
The other is copied on
&lt;a href=&quot;http://jquery.com/&quot;&gt;jQuery&lt;/a&gt; api:
&lt;a href=&quot;http://api.jquery.com/on/&quot;&gt;on&lt;/a&gt;
/
&lt;a href=&quot;http://api.jquery.com/off/&quot;&gt;off&lt;/a&gt;
Pick the one you like. They are doing the same thing.&lt;/p&gt;

&lt;p&gt;Always in a effort to stay close to usual pratices, the events name are the same as in DOM.
The semantic is the same too.
Currently, the available events are
&lt;a href=&quot;http://www.quirksmode.org/dom/events/click.html&quot;&gt;click, dblclick, mouseup, mousedown&lt;/a&gt;,
&lt;a href=&quot;http://www.quirksmode.org/dom/events/mouseover.html&quot;&gt;mouseover and mouse out&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;Some Internals&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;
already has the ability to interact with the mouse.
You can see it in action
&lt;a href=&quot;http://mrdoob.github.com/three.js/examples/webgl_interactive_cubes.html&quot;&gt;here&lt;/a&gt;
and
&lt;a href=&quot;http://mrdoob.github.com/three.js/examples/webgl_interactive_voxelpainter.html&quot;&gt;here&lt;/a&gt;.
Internally they use 2 three.js classes:
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/core/Projector.js&quot;&gt;THREE.Projector&lt;/a&gt;
and
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/core/Ray.js&quot;&gt;THREE.Ray&lt;/a&gt;.
&lt;a href=&quot;https://github.com/jeromeetienne/threex/blob/master/threex.domevent.js&quot;&gt;threex.domevent.js&lt;/a&gt;
is an higher level api on top of those functions,
an interface which mimic dom events,
something closer to the usual web developper.&lt;/p&gt;

&lt;p&gt;It is a nice api. clean, short, object oriented and feels familiar to web developpers.
A little hichup tho, it modifies THREE.Object3D class.
It is a global class, so it may be legitimatly considered unclean by some people.
If this bother you, simply do &lt;code&gt;THREEx.DomEvent.noConflict()&lt;/code&gt; and use the
standalone API. It is documented in the
&lt;a href=&quot;http://jeromeetienne.github.com/threex/docs/threex.domevent.html&quot;&gt;annoted source&lt;/a&gt;.
In fact, the object oriented API is just a thin wrapper
on top of the standalone API.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;We all know the click event when the user click on a webpage.
This experiment wishes to provide to web developpers the same experience in 3D.
I hope people will do crazy innovations by using 3D in user interfaces.
This is a first version. Maybe we will implement
&lt;a href=&quot;http://www.quirksmode.org/js/events_order.html&quot;&gt;bubbling&lt;/a&gt;
in the future, even events like
&lt;a href=&quot;http://www.quirksmode.org/dom/events/change.html&quot;&gt;'change'&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;As usual, &lt;a href=&quot;https://github.com/jeromeetienne/threex/blob/master/threex.domevent.js&quot;&gt;threex.domevent.js&lt;/a&gt;
source is available on
&lt;a href=&quot;https://github.com/jeromeetienne/threex/blob/master/threex.domevent.js&quot;&gt;github&lt;/a&gt;.
There is an
&lt;a href=&quot;http://jeromeetienne.github.com/threex/docs/threex.domevent.html&quot;&gt;annoted source&lt;/a&gt;
for implementation details.
That's all folks. Have fun.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Tunnel Effect for your Demo</title>
    <link href="http://learningthreejs.com/blog/2012/01/11/tunnel-effect/"/>
    <updated>2012-01-11T13:00:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2012/01/11/tunnel-effect</id>
    <content type="html">&lt;p&gt;This post presents a tunnel effect.
This is a classic in 3D demo.
They are visually efficient and easy to code.
In fact, tunnels are so trendy that
even
&lt;a href=&quot;http://en.wikipedia.org/wiki/Doctor_Who&quot;&gt;doctor who&lt;/a&gt;
and
&lt;a href=&quot;http://en.wikipedia.org/wiki/Stargate&quot;&gt;stargate&lt;/a&gt;
have
&lt;a href=&quot;http://www.youtube.com/watch?v=IKo9f5npLNM&quot;&gt;fun&lt;/a&gt;
&lt;a href=&quot;http://www.youtube.com/watch?v=KDIdJtW0vN4&quot;&gt;in them&lt;/a&gt;
:)&lt;/p&gt;

&lt;iframe src=&quot;http://jeromeetienne.github.com/tunnelgl/&quot;
    webkitallowfullscreen mozallowfullscreen allowfullscreen 
    width=&quot;420&quot; height=&quot;315&quot; frameborder=&quot;0&quot; style=&quot;float: right; margin-left: 1em;&quot;&gt;
&lt;/iframe&gt;


&lt;p&gt;&lt;a href=&quot;http://jeromeetienne.github.com/tunnelgl/&quot;&gt;Try the demo&lt;/a&gt;.
It has been built using the
&lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate&quot;&gt;boilerplate for three.js&lt;/a&gt;
seen in a
&lt;a href=&quot;http://learningthreejs.com/blog/2011/12/20/boilerplate-for-three-js/&quot;&gt;previous post&lt;/a&gt;.
The code is simple and small.
Less than 20lines has been added on top of the boilerplate.
We will create a
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/core/Geometry.js&quot;&gt;THREE.Geometry&lt;/a&gt;
to get the shape of tunnel.
Then we will use a
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/textures/Texture.js&quot;&gt;texture&lt;/a&gt;
trick to create the
&lt;a href=&quot;http://en.wikipedia.org/wiki/Optical_illusion&quot;&gt;visual illusion&lt;/a&gt;
of moving.&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;Let's build the walls&lt;/h2&gt;

&lt;p&gt;The first step is to build the &lt;em&gt;walls&lt;/em&gt; of the tunnel.
It is easier that one would expect.
A tunnel may be seen as a cylinder with the camera inside.
Once you realized that, most of the work is done.
Luckily for us,
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;
got an easy way to build cylinders, called
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/geometries/CylinderGeometry.js&quot;&gt;CylinderGeometry&lt;/a&gt;.
Nevertheless our tunnel / cylinder got 2 special points.&lt;/p&gt;

&lt;p&gt;First, it is open-ended. So we must not build its top and bottom.
We need this to see thru its extremities.
This is handled by a parameter in
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/geometries/CylinderGeometry.js&quot;&gt;CylinderGeometry&lt;/a&gt;.
We just set &lt;code&gt;openended&lt;/code&gt; parameter to true and the rest is done for us :)&lt;/p&gt;

&lt;p&gt;Second, the camera is usually located outside of objects.
But our tunnel/cylinder has the camera inside it.
To make our object visible from the inside, we need to turn it inside out.
For that, just use &lt;code&gt;mesh.flipSided = true&lt;/code&gt;&lt;/p&gt;

&lt;h2&gt;Let's go forward&lt;/h2&gt;

&lt;p&gt;Now we need to go forward in this tunnel
For that we will use an old trick.
We won't move the tunnel walls themselves, only their appearance.
It gives the visual illusion that we are moving.
Remember what they say in matrix ?
&lt;a href=&quot;http://www.youtube.com/watch?v=dzm8kTIj_0M&quot;&gt;&quot;there is no spoon&quot;&lt;/a&gt;.
It is all the same, we are moving while staying still :)&lt;/p&gt;

&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/dzm8kTIj_0M?hl=en&amp;fs=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;


&lt;h2&gt;A Texture isn't a spoon&lt;/h2&gt;

&lt;p&gt;First we want to move the appearance of the cylinder, thus the player got the illusion to go forward.
We will use &lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/textures/Texture.js&quot;&gt;THREE.Texture&lt;/a&gt; for that.
We wont move the actual pixels of the textures, only its coordinates.
Additionnaly we want the texture to repeat on the cylinder, thus it appears as continuous.
WebGL texture is a powerfull and flexible tool.
You can tweak so many features.&lt;/p&gt;

&lt;p&gt;First let's make this texture move.
Suppose we want the texture to loop once every 10 seconds.
So the coordinate &lt;code&gt;.offset.y&lt;/code&gt; needs to go from 0 to 1 in 10 seconds.
This line is enougth to make the tunnel move forward.
You can change your speed within the tunnel by changing this number.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;texture.offset.y    += 0.1 * seconds;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Now the texture repetition.
For that we will use a texture parameter called &lt;em&gt;wrap&lt;/em&gt;.
It indicates how the gpu repeat the texture on a face.
Here is a good
&lt;a href=&quot;http://lucera-project.blogspot.com/2010/06/opengl-wrap.html&quot;&gt;tutorial on opengl wrap&lt;/a&gt;.
By default, wrapS / wrapT are set to &lt;code&gt;THREE.ClampToEdgeWrapping&lt;/code&gt;.
So the texture is scaled to match exactly the size of the face.
In our case, we want to repeat the texture and not scale it.
So we use &lt;code&gt;THREE.RepeatWrapping&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;texture.wrapT   = THREE.RepeatWrapping;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;We have seen how to do a tunnel with
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;.
This is very simple to code and awesome on the screen.
It is less than 20 lines added to the &lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate&quot;&gt;boilerplate&lt;/a&gt;.
The cylinder geometry was already provided.
We used
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/textures/Texture.js&quot;&gt;THREE.Texture&lt;/a&gt;
offsets to provide the optical illusion of moving.&lt;/p&gt;

&lt;p&gt;Later, we may add a &lt;a href=&quot;http://en.wikipedia.org/wiki/TARDIS&quot;&gt;blue phonebooth&lt;/a&gt;
and play &lt;em&gt;doctor who&lt;/em&gt; :)
The code is available on
&lt;a href=&quot;https://github.com/jeromeetienne/tunnelgl&quot;&gt;github&lt;/a&gt;
under MIT license.
Feel free to fork and modify.
That's all folks, have fun.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Let’s Make a 3D Game: Supporting Mobile</title>
    <link href="http://learningthreejs.com/blog/2011/12/28/let-s-make-a-3d-game-supporting-mobile/"/>
    <updated>2011-12-28T13:46:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2011/12/28/let-s-make-a-3d-game-supporting-mobile</id>
    <content type="html">&lt;p&gt;This post is about supporting mobile.
We will try to port &lt;a href=&quot;http://marblesoccer.com&quot;&gt;marblesoccer&lt;/a&gt; on mobile.
When doing a
&lt;a href=&quot;http://127.0.0.1:8000/blog/2011/12/20/boilerplate-for-three-js/&quot;&gt;boilerplate for three.js&lt;/a&gt;,
mobile had to be supported for compatibility.
So it gave me the idea of this post.
What about porting our game on mobile ?
Porting a 3D web game to mobile ? crazy :)&lt;/p&gt;

&lt;p&gt;The desktop version looks kindof ok.
What would be the result of this experiment ?
Is that even possible ?
What about usable ?
This is the purpose of this experiment to find out.&lt;/p&gt;

&lt;!-- more --&gt;




&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/Ow_ceac1aEE?hl=en&amp;fs=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;


&lt;h2&gt;Mobile isn't desktop&lt;/h2&gt;

&lt;p&gt;Indeed... desktop and mobile are quite different plateforms.
Which differences are relevant to us ?
First, mobile network is bad, especially latency.
So avoid download of long files, such as texture or sound.
Here is a good talk on
&lt;a href=&quot;http://www.youtube.com/watch?v=L2YqfVNHQO4&quot;&gt;Mobile Web Performance&lt;/a&gt;.
Another thing, mobile got no keyboard, no mouse, but a touch screen
We need to get a game controller for this environement.
We use &lt;a href=&quot;https://github.com/jeromeetienne/virtualjoystick.js&quot;&gt;virtualjoystick.js&lt;/a&gt;.
See details in our &lt;a href=&quot;http://learningthreejs.com/blog/2011/12/26/let-s-make-a-3d-game-virtual-joystick/&quot;&gt;previous post&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;One big thing is that currently, on mobile, WebGL hasnt reached mainstream to say the least.
No major vendor is shipping phone with webgl, so nobody or close get webgl on phone.
So for our little experiment, we will display in
&lt;a href=&quot;http://www.w3.org/TR/2010/WD-2dcontext-20100304/&quot;&gt;Canvas 2D&lt;/a&gt;
with
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/renderers/CanvasRenderer.js&quot;&gt;THREE.CanvasRenderer&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;Porting to canvas 2D&lt;/h2&gt;

&lt;p&gt;So what need to be done ?
First step is to use the proper renderer when suitable.
Second is fixing material and geometry to fit canvas2D renderer capability.
Last step is to look for room of optimisations.
Ok now let's intanciate the renderer. If webgl is available, use
&lt;code&gt;THREE.WebGLRenderer&lt;/code&gt;
else use
&lt;code&gt;THREE.CanvasRenderer&lt;/code&gt;.
Not too hard hey ?
We already did that in the
&lt;a href=&quot;http://learningthreejs.com/blog/2011/12/20/boilerplate-for-three-js/&quot;&gt;boilerplate for three.js&lt;/a&gt;&lt;/p&gt;

&lt;iframe src=&quot;http://marblesoccer.com?render=canvas&amp;bypasslanding=1&quot;
    webkitallowfullscreen mozallowfullscreen allowfullscreen 
    width=&quot;420&quot; height=&quot;315&quot; frameborder=&quot;0&quot; style=&quot;float: right; margin-left: 1em;&quot;&gt;
&lt;/iframe&gt;


&lt;p&gt;We simplify geometry to reduce the number of polygon.
For marble geometry, the sphere got 512 faces on webgl, and only 9 on canvas2d.
Drastic :)
What about material ? For webgl, we used
&lt;a href=&quot;http://en.wikipedia.org/wiki/Phong_shading&quot;&gt;phong&lt;/a&gt;
for fancy lightings,
We used
&lt;a href=&quot;http://en.wikipedia.org/wiki/Texture_mapping&quot;&gt;textures&lt;/a&gt;
for realistic effects.
But with canvas2D, those technics cant be used.
They are way too slow.&lt;/p&gt;

&lt;p&gt;This is enougth to get it working.
It display something reasonable on the screen at least.
We sacrifice a lot tho, no more texture not fancy lighting.
And now the bad new, it results in 3fps on my ipad2 ios4... ouch.&lt;/p&gt;

&lt;h2&gt;More measures&lt;/h2&gt;

&lt;p&gt;How come performances are so bad ? So i did more measures.
I disabled the display of map and marbles to see how they impact performance.
If we display the map and the marbles, we got 3fps on my ipad2.
If we display only marbles, no more maps, we got 23fps, much better.
but still not great... Considere that we are only displaying marbles and they are real simple.&lt;/p&gt;

&lt;p&gt;If we display no marble, and no map. we got only 30fps. So all the rest, all the non display
part is already using a big part of time ? what are we doing ? not much...
Still we run
&lt;a href=&quot;http://learningthreejs.com/blog/2011/10/17/lets-make-a-3d-game-microphysics-js/&quot;&gt;realistic 3D physics&lt;/a&gt;
and ipad2 cpu isnt as fast as usual desktop ones.&lt;/p&gt;

&lt;h2&gt;Time to optimize&lt;/h2&gt;

&lt;p&gt;Ok it is slow but this is a first try.
I admit the code isnt not too optimized.
&lt;a href=&quot;http://en.wikipedia.org/wiki/Central_processing_unit&quot;&gt;cpu&lt;/a&gt;
/
&lt;a href=&quot;http://en.wikipedia.org/wiki/Graphics_processing_unit&quot;&gt;gpu&lt;/a&gt;
performance are so good on desktop, i may have been sloppy here and there :)
There are areas of optimisations.
We need to draw less polygons.&lt;/p&gt;

&lt;p&gt;First we need to &lt;em&gt;reduce the geometry&lt;/em&gt; of the map.
We can do that by clustering voxels:
if 2 voxels got the same color and touch each other, display one large box, instead of 2 small boxes.
We did it to optimize our physics.
See details in &lt;a href=&quot;http://learningthreejs.com/blog/2011/10/17/lets-make-a-3d-game-microphysics-js/&quot;&gt;microphysics post&lt;/a&gt;.
Additionnaly we could use marblesoccer's
&lt;a href=&quot;http://127.0.0.1:8000/blog/2011/09/14/lets-make-a-3D-game-map-editor/&quot;&gt;map editor&lt;/a&gt;
to redesign a map with a simpler geometry.&lt;/p&gt;

&lt;p&gt;Another low-hanging fruit is to remove faces which are never seen, like in
&lt;a href=&quot;http://mrdoob.github.com/three.js/examples/webgl_geometry_minecraft_ao.html&quot;&gt;minecraft example&lt;/a&gt;
from
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;.
We could try to 2D sprites instead of 3D spheres for marble.
We wont use
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/objects/Sprite.js&quot;&gt;THREE.Sprite&lt;/a&gt;.
It isnt supported
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/renderers/CanvasRenderer.js&quot;&gt;THREE.CanvasRenderer&lt;/a&gt;.
But dont worry, it is possible with the particle system.
See how &lt;code&gt;THREE.Particle&lt;/code&gt; is used in
&lt;a href=&quot;http://mrdoob.github.com/three.js/examples/canvas_particles_sprites.html&quot;&gt;canvas_particles_sprites.html&lt;/a&gt;
example.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;And after all that, what can you expect ?
Will that run at 60fps ? 30fps ? Not likely or it will require a lot of effort.
&lt;img class='left ' src='http://learningthreejs.com/data/lets-make-a-3d-game-supporting-mobile/images/screenshot-webgl-small.png' width='' height='' alt='' title=''&gt;
&lt;img class='right ' src='http://learningthreejs.com/data/lets-make-a-3d-game-supporting-mobile/images/screenshot-canvas-small.png' width='' height='' alt='' title=''&gt;
So animations arent smooth, what about the look?
Watch what you got on the screen...
On the right, a canvas version. &lt;a href=&quot;http://marblesoccer.com/?render=canvas&quot;&gt;live here&lt;/a&gt;.
On the left you can see a webgl version. &lt;a href=&quot;http://marblesoccer.com&quot;&gt;live here&lt;/a&gt;.
Lets face it... &lt;em&gt;canvas version is ugly&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;After a significant work, you get poor performance and crappy look.
Not many players would accept that...
currently canvas performance doesnt seems suitable to display 3D on mobile.
It is a good way to monitor performances and see how they evolve with time.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Let’s Make a 3D Game: Virtual Joystick</title>
    <link href="http://learningthreejs.com/blog/2011/12/26/let-s-make-a-3d-game-virtual-joystick/"/>
    <updated>2011-12-26T12:21:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2011/12/26/let-s-make-a-3d-game-virtual-joystick</id>
    <content type="html">&lt;p&gt;Here is another article of the &quot;Let's Make a 3D Game&quot;
&lt;a href=&quot;http://learningthreejs.com/blog/categories/tutorial3dgame/&quot;&gt;series&lt;/a&gt;.
We have already seen how to handle other inputs like
&lt;a href=&quot;http://learningthreejs.com/blog/2011/09/12/lets-Make-a-3D-game-keyboard/&quot;&gt;keyboard&lt;/a&gt;
and
&lt;a href=&quot;http://learningthreejs.com/blog/2011/09/20/lets-make-a-3D-game-device-orientation/&quot;&gt;device orientation&lt;/a&gt;.
This post is about &lt;a href=&quot;https://github.com/jeromeetienne/virtualjoystick.js&quot;&gt;virtualjoystick.js&lt;/a&gt;
It &lt;strong&gt;virtual joystick&lt;/strong&gt;, another input you can use for your games.
A virtual joystick emulates a joystick behaviour on a touch screen.
&lt;a href=&quot;https://github.com/jeromeetienne/virtualjoystick.js&quot;&gt;virtualjoystick.js&lt;/a&gt;
has been coded in a effort to port
&lt;a href=&quot;http://marblesoccer.com&quot;&gt;marblesoccer&lt;/a&gt;
to mobile device.
Show, dont tell,
&lt;a href=&quot;http://jeromeetienne.github.com/virtualjoystick.js/&quot;&gt;Try it out&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This
&lt;a href=&quot;http://jeromeetienne.github.com/virtualjoystick.js/&quot;&gt;demo&lt;/a&gt;
works with mouse events too thus, it is easier to test/debug.
&lt;a href=&quot;https://github.com/jeromeetienne/virtualjoystick.js&quot;&gt;virtualjoystick.js&lt;/a&gt;
has been widely inpired by
&lt;a href=&quot;http://sebleedelisle.com/2011/04/multi-touch-game-controller-in-javascripthtml5-for-ipad/&quot;&gt;this post&lt;/a&gt;
by
&lt;a href=&quot;http://sebleedelisle.com/&quot;&gt;Seb Lee-Delisle&lt;/a&gt;.
The screencast below is short introduction about
&lt;a href=&quot;https://github.com/jeromeetienne/virtualjoystick.js&quot;&gt;virtualjoystick.js&lt;/a&gt;&lt;/p&gt;

&lt;!-- more --&gt;




&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/viyr_W0z1U8?hl=en&amp;fs=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;


&lt;h2&gt;Let's Get Started&lt;/h2&gt;

&lt;p&gt;First step, you download
&lt;a href=&quot;https://raw.github.com/jeromeetienne/virtualjoystick.js/master/virtualjoystick.js&quot;&gt;virtualjoystick.js&lt;/a&gt;
from its
&lt;a href=&quot;https://github.com/jeromeetienne/virtualjoystick.js&quot;&gt;github&lt;/a&gt;
Then include it in your own code.&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src=&quot;virtualjoystick.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;The joystick is composed of 2 parts: the &lt;em&gt;base&lt;/em&gt; and the &lt;em&gt;stick&lt;/em&gt;.
First the plare touch the screen, it gives the position of the &lt;em&gt;base&lt;/em&gt;.
Then it drags its fingers to gives the position of the &lt;em&gt;stick&lt;/em&gt;&lt;/p&gt;

&lt;h2&gt;Let's Use it&lt;/h2&gt;

&lt;iframe src=&quot;http://jeromeetienne.github.com/virtualjoystick.js/&quot;
    webkitallowfullscreen mozallowfullscreen allowfullscreen 
    width=&quot;420&quot; height=&quot;315&quot; frameborder=&quot;0&quot; style=&quot;float: right; margin-left: 1em;&quot;&gt;
&lt;/iframe&gt;


&lt;p&gt;First step is to create the object from &lt;code&gt;VirtualJoystick&lt;/code&gt; class.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var joystick = new VirtualJoystick()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;The constructor has some options.
They have sensible default.
You can change them to fit your specific needs.
See
&lt;a href=&quot;https://github.com/jeromeetienne/virtualjoystick.js#readme&quot;&gt;github README&lt;/a&gt;
for a full API description.
You may look at the &lt;a href=&quot;https://github.com/jeromeetienne/virtualjoystick.js/blob/master/index.html&quot;&gt;index.html&lt;/a&gt;.
It is an example which uses the library.&lt;/p&gt;

&lt;p&gt;It is possible to read
&lt;a href=&quot;http://en.wikipedia.org/wiki/Analog_stick&quot;&gt;analogic&lt;/a&gt;
coordinates.
&lt;code&gt;joystick.deltaX()&lt;/code&gt; gives the &lt;em&gt;delta x&lt;/em&gt; between the base and the stick in pixel.
&lt;code&gt;joystick.deltaY()&lt;/code&gt; gives the &lt;em&gt;delta y&lt;/em&gt;.
Those analogic coordinates may be interpreted as a
&lt;a href=&quot;http://www.slagcoin.com/joystick/restrictors.html&quot;&gt;joystick with 4 switches&lt;/a&gt;.
Similar to
&lt;a href=&quot;http://en.wikipedia.org/wiki/Arrow_keys&quot;&gt;arrow keys&lt;/a&gt;
in a way.
&lt;code&gt;joystick.up()&lt;/code&gt; tells you if your joystick is up or not.
You guessed the meaning of &lt;code&gt;.down()&lt;/code&gt;, &lt;code&gt;.right()&lt;/code&gt; and &lt;code&gt;.left()&lt;/code&gt;.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;The source is available on
&lt;a href=&quot;https://github.com/jeromeetienne/virtualjoystick.js&quot;&gt;github&lt;/a&gt;
under MIT license.
Later, a button may be implemented as well.
It is alway usefull to able to fire in video games :)
That's all folks, have fun.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Boilerplate for Three.js</title>
    <link href="http://learningthreejs.com/blog/2011/12/20/boilerplate-for-three-js/"/>
    <updated>2011-12-20T19:09:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2011/12/20/boilerplate-for-three-js</id>
    <content type="html">&lt;p&gt;This post presents
&lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate&quot;&gt;boilerplate for three.js&lt;/a&gt;.
I looked at
&lt;a href=&quot;http://html5boilerplate.com/&quot;&gt;html5 boilerplate&lt;/a&gt;
and found
&lt;a href=&quot;http://www.youtube.com/watch?v=NMEB78VX2P0&quot;&gt;it&lt;/a&gt;
&lt;a href=&quot;http://www.youtube.com/watch?v=oDlsOyPKUTM&quot;&gt;awesome&lt;/a&gt;.
&lt;a href=&quot;http://html5boilerplate.com/&quot;&gt;html5 boilerplate&lt;/a&gt;
is a fast way start a clean project.
It avoids repetitive tasks, following &lt;a href=&quot;http://en.wikipedia.org/wiki/Don't_repeat_yourself&quot;&gt;DRY&lt;/a&gt; principles.
It includes all those good practices, which are so easy to forget.
It seems all good to me :)
&lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate&quot;&gt;boilerplate for three.js&lt;/a&gt; tries to apply similar principles.
I frequently write simple three.js demo for tutorials, and repeat the first steps way too often for my tastes :)
It has been done in effort to make 3D on the web even easier.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://jeromeetienne.github.com/threejsboilerplate/&quot;&gt;Try it&lt;/a&gt; out.
&quot;Boilerplate for three.js is a web template for a fast, robust and future-proof site.
Boilerplate is not a framework, nor does it prescribe any philosophy of
development, it's just got some tricks to get your project off the ground
quickly and right-footed.&quot;
- freely adapted from &lt;a href=&quot;http://html5boilerplate.com/&quot;&gt;html5 boilerplate site&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;Walkthrough&lt;/h2&gt;

&lt;p&gt;This project is at an early stage.
Dont hesitate to suggest improvements or
bug fixes in
&lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate/issues&quot;&gt;github issues&lt;/a&gt;.
It has been done to run everywhere, and to promote good practices.
The
&lt;a href=&quot;http://www.youtube.com/watch?v=kOReCN5t2Eo&quot;&gt;screencast&lt;/a&gt;
below will walk you through the source of the project.
22min... a long one :)&lt;/p&gt;

&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/kOReCN5t2Eo?hl=en&amp;fs=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;




&lt;!-- more --&gt;


&lt;h2&gt;Compatibility is key&lt;/h2&gt;

&lt;p&gt;It has to run everywhere.
We believe that compatibility is crucial on the web.
The boilerplate seamlessly works on desktop and mobile.
It is working on webgl/canvas2d and supports mouse/touch events.&lt;/p&gt;

&lt;p&gt;It renders on
&lt;a href=&quot;http://en.wikipedia.org/wiki/WebGL&quot;&gt;webgl&lt;/a&gt;
if available, else it fallbacks on
&lt;a href=&quot;http://html5doctor.com/an-introduction-to-the-canvas-2d-api/&quot;&gt;canvas2D&lt;/a&gt;.
It is often forgotten, but &lt;a href=&quot;&quot;&gt;three.js&lt;/a&gt; is able render on various backends,
they are called &lt;a href=&quot;https://github.com/mrdoob/three.js/tree/master/src/renderers&quot;&gt;renderers&lt;/a&gt;.
It isnt always possible to fallback tho.
Materials are especially sensible to the type of renderer you use.
For examples, many materials are webgl specific as they contains shaders and canvas2D got no shaders.
Up to you to find the balance that fit your needs.&lt;/p&gt;

&lt;p&gt;The camera controls is rather basic.
If you need a different controls for your camera, pick one in
&lt;a href=&quot;https://github.com/mrdoob/three.js/tree/master/src/extras/controls&quot;&gt;this list&lt;/a&gt;.
This one is simple to use and understand, a nice feature for a boilerplate.
It supports
&lt;a href=&quot;http://www.quirksmode.org/js/events_mouse.html&quot;&gt;mouse events&lt;/a&gt;
and
&lt;a href=&quot;https://developer.mozilla.org/en/DOM/Touch_events&quot;&gt;touch events&lt;/a&gt;.
So you can run with a touch screen with a glitch.&lt;/p&gt;

&lt;h2&gt;Good Practices&lt;/h2&gt;

&lt;p&gt;Some features have been added: fullscreen, screenshot and window resize.
I consider them &lt;a href=&quot;http://en.wikipedia.org/wiki/Best_practice&quot;&gt;good pratices&lt;/a&gt; which are often forgotten.
Some numbers based on &lt;a href=&quot;https://github.com/mrdoob/three.js/tree/master/examples&quot;&gt;three.js examples&lt;/a&gt;:
128 examples total,
26 of them handle touch events,
11 handle window resize,
2 handle screenshot,
0 handle fullscreen.&lt;/p&gt;

&lt;iframe src=&quot;http://jeromeetienne.github.com/threejsboilerplate&quot;
    webkitallowfullscreen mozallowfullscreen allowfullscreen 
    width=&quot;420&quot; height=&quot;315&quot; frameborder=&quot;0&quot; style=&quot;float: right; margin-left: 1em;&quot;&gt;
&lt;/iframe&gt;


&lt;p&gt;&lt;strong&gt;Fullscreen&lt;/strong&gt; is supported to enjoy your 3D on a large display
without visual distraction.
If you press &lt;em&gt;f&lt;/em&gt;, your demo will go fullscreen.
For technical details, see &quot;&lt;a href=&quot;http://learningthreejs.com/blog/2011/11/17/lets-make-a-3d-game-make-it-fullscreen/&quot;&gt;Make It Fullscreen&lt;/a&gt;&quot; post.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Screenshot&lt;/strong&gt; makes it easy to share the image
as what you see on the screen at a given moment.
If you press &lt;em&gt;p&lt;/em&gt;, a new tab will open with a screenshot of the rendered content.
For technical details, see &quot;&lt;a href=&quot;http://learningthreejs.com/blog/2011/09/03/screenshot-in-javascript/&quot;&gt;screenhot in javascript&lt;/a&gt;&quot; post.
It it usefull to share nice images and to help debug on various plateforms.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Window resize&lt;/strong&gt; is supported because it is required. Without it, your 3D scene will loose scaleing and center
when you resize the window or go fullscreen.
For technical details, see &quot;&lt;a href=&quot;http://learningthreejs.com/blog/2011/08/30/window-resize-for-your-demos/&quot;&gt;window resize your demos&lt;/a&gt;&quot; post.&lt;/p&gt;

&lt;h2&gt;How to use it ?&lt;/h2&gt;

&lt;p&gt;It is quite simple, first you download the code as
a &lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate/zipball/master&quot;&gt;.zip file&lt;/a&gt;
or with the &lt;a href=&quot;http://git-scm.com/&quot;&gt;git&lt;/a&gt; command line below.&lt;/p&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone git://github.com/jeromeetienne/threejsboilerplate.git
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;then start updating &lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate/blob/master/index.html&quot;&gt;index.html&lt;/a&gt; to
fit your needs.
Below is a screencast where i use the
&lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate&quot;&gt;boilerplate&lt;/a&gt;
to display a
&lt;a href=&quot;http://en.wikipedia.org/wiki/Utah_teapot&quot;&gt;teapot&lt;/a&gt;
in only 3min!
Why a teapot ? Because it is the &quot;hello world&quot; of 3D :)
Be warned, the video is a bit speedy, im just starting at doing screencast.
Next ones will hopefully be slower.&lt;/p&gt;

&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/0XPOCi6FJX0?hl=en&amp;fs=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;


&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;Later, it may be cool to have a builder.
I think it may be possible to make it client only.
&lt;a href=&quot;http://jszip.stuartk.co.uk/&quot;&gt;jszip&lt;/a&gt; library would create the zip containing all the files.
&lt;a href=&quot;https://github.com/jeromeetienne/shorttag.js&quot;&gt;shorttag.js&lt;/a&gt; library would compile templates according to user needs.
A builder would produce a cleaner and smaller result for you to play with.&lt;/p&gt;

&lt;p&gt;I gave a short talk at &lt;a href=&quot;http://parisjs.org&quot;&gt;parisjs&lt;/a&gt; about it, here are the &lt;a href=&quot;http://jeromeetienne.github.com/slides-3jsbp-parisjs14&quot;&gt;slides&lt;/a&gt;.
I hope
&lt;a href=&quot;https://github.com/jeromeetienne/threejsboilerplate&quot;&gt;boilerplate for three.js&lt;/a&gt;.
will help make
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;
even easier to use.
This project is quite new and will likely improve soon.
That's all folks, have fun :)&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Particles: Online Editor for Sparks.js</title>
    <link href="http://learningthreejs.com/blog/2011/12/19/particles-online-editor-for-sparks-js/"/>
    <updated>2011-12-19T12:11:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2011/12/19/particles-online-editor-for-sparks-js</id>
    <content type="html">&lt;p&gt;This post is the second of our &lt;a href=&quot;http://learningthreejs.com/blog/categories/particles&quot;&gt;serie on particles&lt;/a&gt;.
It presents
&lt;a href=&quot;https://github.com/jeromeetienne/sparkseditor&quot;&gt;sparkseditor&lt;/a&gt;
, an online editor for
&lt;a href=&quot;https://github.com/zz85/sparks.js&quot;&gt;sparks.js&lt;/a&gt;
with
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;.
In a few word, it is a webpage which provide an text editor
with a
&lt;a href=&quot;https://github.com/zz85/sparks.js&quot;&gt;sparks.js&lt;/a&gt;
effect.
You got the code in the editor
and
you see &lt;em&gt;live&lt;/em&gt; the resulting particles effect.
I like this &lt;em&gt;live&lt;/em&gt; aspect a lot :)
I think it makes your design more direct, lower latency, less overhead.
More creative in a way.
&lt;a href=&quot;http://jeromeetienne.github.com/sparkseditor/&quot;&gt;Try it out&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This editor has been made to lower the barrier of entry on
&lt;a href=&quot;https://github.com/zz85/sparks.js&quot;&gt;sparks.js&lt;/a&gt;
with
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;
particles.
The UI is rather simple and obvious. You can find a small presentation in the
screencast below.&lt;/p&gt;

&lt;!-- more --&gt;




&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/nu00FhIW5bc?hl=en&amp;fs=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;


&lt;h2&gt;Live editor rocks&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://jeromeetienne.github.com/sparkseditor/&quot;&gt;Sparkseditor&lt;/a&gt;
is widely inpired by
&lt;a href=&quot;http://glsl.heroku.com/e&quot;&gt;glsl editor&lt;/a&gt;
from
&lt;a href=&quot;http://mrdoob.com/&quot;&gt;mrdoob&lt;/a&gt;
and
&lt;a href=&quot;http://www.iquilezles.org/apps/shadertoy/&quot;&gt;shadertoy&lt;/a&gt;
from
&lt;a href=&quot;http://www.iquilezles.org/&quot;&gt;Inigo Quilez&lt;/a&gt;.
On the same vibe,
&lt;a href=&quot;http://lea.verou.me/&quot;&gt;lea verou&lt;/a&gt;
recently
released
&lt;a href=&quot;http://lea.verou.me/2011/12/introducing-dabblet-an-interactive-css-playground/&quot;&gt;dablet&lt;/a&gt;,
an online editor for
&lt;a href=&quot;http://en.wikipedia.org/wiki/Cascading_Style_Sheets&quot;&gt;css&lt;/a&gt;.
There is a clear trend here...
What is it about those live editors ?
A live editor produces a result immediatly.
This helps design your effect faster.
Be light on your foot kindof style.
Very agile way to design.&lt;/p&gt;

&lt;p&gt;Additionally, it is easy to share with others because we have &lt;em&gt;bookmarkability&lt;/em&gt;.
We do that by storing state in url.
On the down side, it makes super long+ugly urls...
&lt;a href=&quot;http://en.wikipedia.org/wiki/URL_shortening&quot;&gt;url shortening&lt;/a&gt;
helps us reduces this issue.
In our case, we use
&lt;a href=&quot;https://bitly.com/&quot;&gt;bitly&lt;/a&gt;
service.&lt;/p&gt;

&lt;p&gt;This editor is purely static files.
No specific server to run, no need to admin and no risk to go offline.
Oh and by the way i dont not even have to pay for hosting this application.
I think it shows html5 in all its power.
The web is becoming something real nice :) html5 i love you!&lt;/p&gt;

&lt;h2&gt;conclusion&lt;/h2&gt;

&lt;p&gt;Under the hood,
&lt;a href=&quot;https://github.com/jeromeetienne/sparkseditor&quot;&gt;sparkseditor&lt;/a&gt;
uses
&lt;a href=&quot;https://github.com/jeromeetienne/threex/blob/master/threex.sparks.js&quot;&gt;threex.sparks.js&lt;/a&gt;, a
&lt;a href=&quot;https://github.com/jeromeetienne/threex&quot;&gt;threex&lt;/a&gt;
helper, to make
&lt;a href=&quot;https://github.com/zz85/sparks.js/&quot;&gt;sparks.js&lt;/a&gt;
even easier to use.
This helper will be the subject of a future post of our
&lt;a href=&quot;http://learningthreejs.com/blog/categories/particles&quot;&gt;particles series&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The source is open-source under
&lt;a href=&quot;https://github.com/jeromeetienne/sparkseditor/blob/master/MIT-LICENSE.txt&quot;&gt;MIT&lt;/a&gt;.
You can get it in its &lt;a href=&quot;https://github.com/jeromeetienne/sparkseditor&quot;&gt;git repository&lt;/a&gt;.
If you hit bugs, fill issues on github.
Feel free to fork and modify it!
That's all folks, have fun :)&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Particles: Introduction to Sparks.js</title>
    <link href="http://learningthreejs.com/blog/2011/12/14/particles-introduction-to-sparks-js/"/>
    <updated>2011-12-14T12:08:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2011/12/14/particles-introduction-to-sparks-js</id>
    <content type="html">&lt;p&gt;This post is the first of a &lt;a href=&quot;http://learningthreejs.com/blog/categories/particles&quot;&gt;serie on particles&lt;/a&gt;.
It specifically is about
&lt;a href=&quot;https://github.com/zz85/sparks.js&quot;&gt;sparks.js&lt;/a&gt;.
&lt;em&gt;sparks.js&lt;/em&gt; is lightweight 3d
&lt;a href=&quot;http://en.wikipedia.org/wiki/Particle_system&quot;&gt;Particle system&lt;/a&gt;
in javascript, for use with
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;
and
&lt;a href=&quot;https://github.com/sole/tween.js&quot;&gt;tween.js&lt;/a&gt;.
It is from
&lt;a href=&quot;http://www.lab4games.net/zz85/blog/&quot;&gt;zz85&lt;/a&gt;
who already did
&lt;a href=&quot;http://mrdoob.github.com/three.js/examples/webgl_geometry_text.html&quot;&gt;3D text&lt;/a&gt;
and
&lt;a href=&quot;http://mrdoob.github.com/three.js/examples/webgl_geometry_subdivison.html&quot;&gt;Catmull Clark subdivision&lt;/a&gt;.
a productive guy :)&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;http://mrdoob.github.com/three.js/examples/webgl_particles_shapes.html&quot;&gt;demo&lt;/a&gt;
below is one of the many &lt;a href=&quot;https://github.com/mrdoob/three.js/tree/master/examples&quot;&gt;three.js examples&lt;/a&gt;.
While im on it, the &lt;a href=&quot;https://github.com/mrdoob/three.js/tree/master/examples&quot;&gt;example directory&lt;/a&gt; is a gold mine.
Go dig in it to understand how to code three.js :)
Back to the point, this
&lt;a href=&quot;http://mrdoob.github.com/three.js/examples/webgl_particles_shapes.html&quot;&gt;demo&lt;/a&gt;
is rather cool no ?
You want to do the same ?
During this short post, let me walk you walk thru the code for particles in this example.&lt;/p&gt;

&lt;!-- more --&gt;




&lt;iframe src=&quot;http://mrdoob.github.com/three.js/examples/webgl_particles_shapes.html&quot; width=&quot;100%&quot; height=&quot;420&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;


&lt;h2&gt;Lets Get Started&lt;/h2&gt;

&lt;p&gt;So lets see how to use it. First step, you download
&lt;a href=&quot;https://raw.github.com/zz85/sparks.js/master/Sparks.js&quot;&gt;sparks.js&lt;/a&gt;
from
&lt;a href=&quot;https://github.com/zz85/sparks.js&quot;&gt;its github&lt;/a&gt;.
Then include it in your own code.&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src=&quot;Sparks.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;First a few words on what is a &lt;a href=&quot;http://en.wikipedia.org/wiki/Particle_system&quot;&gt;particle system&lt;/a&gt;.
It is usually composed of 2 big parts: the &lt;em&gt;emitter&lt;/em&gt; and the &lt;em&gt;particle&lt;/em&gt; itself.
Emitter creates particles.
Particles are usually smallish objects on the screen.
As you got many particles at the same time, they appears a single mass.&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;Let's create an emitter&lt;/h2&gt;

&lt;p&gt;First we create the emitter like this.
&lt;code&gt;emitter&lt;/code&gt; is the main object we will play with.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var counter = new SPARKS.SteadyCounter( 500 );
var emitter = new SPARKS.Emitter( counter );
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;&lt;code&gt;counter&lt;/code&gt; controls how frequently particles are created. Here it will
emit 500 particles per seconds.
Now let's start emit particles.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;emitter.start();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Sparks.js has a very flexible core.
It mainly uses two stacks of functions.
&lt;em&gt;Initializers&lt;/em&gt; is the stack run at the creation of a particle.
&lt;em&gt;Actions&lt;/em&gt; is another stack which is run at every step of a particle life.
Those functions are run in order.
Up to you to configure them to fit your needs.
You can easily code your own &lt;em&gt;initializer&lt;/em&gt; or &lt;em&gt;action&lt;/em&gt;.
Dont worry it got a bunch of predefined ones.&lt;/p&gt;

&lt;h2&gt;Let's initialize&lt;/h2&gt;

&lt;p&gt;Lets me walk you thru the ones used in our example. The whole stack is below.
&lt;code&gt;emitter.addInitializer()&lt;/code&gt; to push a new initializer, and &lt;code&gt;emitter.removeInitializer()&lt;/code&gt;
to remove it, not too hard :)&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;emitterpos = new THREE.Vector3( 0, 0, 0 );
emitter.addInitializer( new SPARKS.Position( new SPARKS.PointZone( emitterpos ) ) );
emitter.addInitializer( new SPARKS.Lifetime( 1, 15 ));
var vector = new THREE.Vector3( 0, -5, 1 );
emitter.addInitializer( new SPARKS.Velocity( new SPARKS.PointZone( vector ) ) );
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;&lt;code&gt;SPARKS.Position(zone)&lt;/code&gt; initializer set the original position of the particle.
A &lt;code&gt;zone&lt;/code&gt; provide a location in space.
&lt;code&gt;new SPARKS.PointZone( emitterpos )&lt;/code&gt; means the particles will always start from this specific point in space.
It is possible to have other zones.
For example, &lt;code&gt;SPARKS.LineZone( startVector3, endVector3 )&lt;/code&gt; represents a line between 2 points, so
your particle would start anywhere on this line.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;SPARKS.Lifetime(mintime, maxtime)&lt;/code&gt; initializer set particle's lifetime.
You can specify a range and a random value will be assigned.
Don't forget to add &lt;code&gt;SPARKS.Age&lt;/code&gt; action to handle its lifetime.
And the last one.
&lt;code&gt;SPARKS.Velocity(zone)&lt;/code&gt; set particle's velocity based on a &lt;code&gt;zone&lt;/code&gt; location.
The initializer stack is setup the particle at the begining of its life.
Let's see what happen during this life.&lt;/p&gt;

&lt;h2&gt;Let's do some actions&lt;/h2&gt;

&lt;p&gt;Actions are performed at every step of a particle life.
Same as with initializers, &lt;code&gt;emitter.addAction()&lt;/code&gt; to push a new action,
&lt;code&gt;emitter.removeAction()&lt;/code&gt; to remove it.
For our examples the whole action stack is this.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;emitter.addAction( new SPARKS.Age() );
emitter.addAction( new SPARKS.Accelerate( 0, 0, -50 ) );
emitter.addAction( new SPARKS.Move() );
emitter.addAction( new SPARKS.RandomDrift( 90, 100, 2000 ) );
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Now lets details it.
We have already seen &lt;code&gt;SPARKS.Age()&lt;/code&gt;. It is handle the lifetime of each particle.
&lt;code&gt;SPARKS.Accelerate(x,y,z)&lt;/code&gt; changes the velocity by adding a fixed amount at every step.
This one produces a gravity effect with a negative &lt;code&gt;y&lt;/code&gt;.
&lt;code&gt;SPARKS.Move()&lt;/code&gt; makes the particles move in our 3D space.
&lt;code&gt;SPARKS.RandomDrift(x,y,z)&lt;/code&gt; changes the velocity by adding a random amount at every step.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;I hope this short introduction got you excited about
&lt;a href=&quot;https://github.com/zz85/sparks.js/&quot;&gt;sparks.js&lt;/a&gt;.
Next posts on the
&lt;a href=&quot;http://learningthreejs.com/blog/categories/particles&quot;&gt;particle series&lt;/a&gt;
may be a UI editor, stay tuned!
I find sparks.js clean and flexible.
Flexibility is very important for particles.
It helps provide a wide variety of effect in your games/demos.
For more informations and authoritative answer, see the
&lt;a href=&quot;https://github.com/zz85/sparks.js/&quot;&gt;github repository&lt;/a&gt;.
That's all for today folks, have fun.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Constructive Solid Geometry With csg.js</title>
    <link href="http://learningthreejs.com/blog/2011/12/10/constructive-solid-geometry-with-csg-js/"/>
    <updated>2011-12-10T16:30:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2011/12/10/constructive-solid-geometry-with-csg-js</id>
    <content type="html">&lt;p&gt;This post is about
&lt;a href=&quot;http://en.wikipedia.org/wiki/Constructive_solid_geometry&quot;&gt;constructive solid geometry&lt;/a&gt;
, an impressive word :)
In fact, it is just a way to build complex objects from simpler ones.
Those simple objects are assembled using
&lt;a href=&quot;http://en.wikipedia.org/wiki/Algebra_of_sets&quot;&gt;operations&lt;/a&gt;
such as union, difference and intersection.&lt;/p&gt;

&lt;iframe src=&quot;http://learningthreejs.com/data/constructive-solid-geometry-with-csg-js/&quot;
    width=&quot;420&quot; height=&quot;315&quot; frameborder=&quot;0&quot; style=&quot;float: right; margin-left: 1em;&quot;&gt;
&lt;/iframe&gt;


&lt;p&gt;Recently
&lt;a href=&quot;http://madebyevan.com/&quot;&gt;Evan Wallas&lt;/a&gt;
released
&lt;a href=&quot;http://evanw.github.com/csg.js/&quot;&gt;csg.js&lt;/a&gt;,
a clean self-contained library to do
&lt;a href=&quot;http://en.wikipedia.org/wiki/Constructive_solid_geometry&quot;&gt;constructive solid geometry&lt;/a&gt;.
So &lt;a href=&quot;http://chandler.prallfamily.com/&quot;&gt;Chandler Prall&lt;/a&gt;
wrote a
&lt;a href=&quot;http://chandler.prallfamily.com/2011/12/constructive-solid-geometry-with-three-js/&quot;&gt;bridge&lt;/a&gt;
to make it easy to use with
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;With all this nice code, i wrote the little
&lt;a href=&quot;http://learningthreejs.com/data/constructive-solid-geometry-with-csg-js/&quot;&gt;demo of a dice&lt;/a&gt;
you can see on the right. Thus you can click to change the operations, play
with it and have a feel of the various operations.&lt;/p&gt;

&lt;h2&gt;Let's start&lt;/h2&gt;

&lt;p&gt;So lets see how to use it. First step, you download
csg.js from
&lt;a href=&quot;http://evanw.github.com/csg.js/&quot;&gt;here&lt;/a&gt;
, ThreeCSG.js bridge from
&lt;a href=&quot;http://chandler.prallfamily.com/labs/three/csg/ThreeCSG.js&quot;&gt;here&lt;/a&gt;
. Then include those line in your own code.&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src=&quot;csg.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script src=&quot;ThreeCSG.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;Let's convert&lt;/h2&gt;

&lt;p&gt;Ok now that we got the source, let's use it.
&lt;a href=&quot;http://chandler.prallfamily.com/2011/12/constructive-solid-geometry-with-three-js/&quot;&gt;ThreeCSG.js&lt;/a&gt;
is a bridge between
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;
and
&lt;a href=&quot;http://evanw.github.com/csg.js/&quot;&gt;csg.js&lt;/a&gt;.
Both libraries use a different format for geometry.
&lt;a href=&quot;http://chandler.prallfamily.com/2011/12/constructive-solid-geometry-with-three-js/&quot;&gt;ThreeCSG.js&lt;/a&gt;
does the conversion back and forth.
To convert your three.js geometry to a csg geometry, use this line.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var geometryCsg = THREE.CSG.toCSG(geometryThree);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Then you likely apply
&lt;a href=&quot;http://en.wikipedia.org/wiki/Algebra_of_sets&quot;&gt;boolean operations&lt;/a&gt;
on
&lt;a href=&quot;http://evanw.github.com/csg.js/&quot;&gt;csg.js&lt;/a&gt; geometry.
To convert it back to three.js, just do&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var geometryThree   = THREE.CSG.fromCSG(geometryCsg);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;You end up with a normal &lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/core/Geometry.js&quot;&gt;three.js geometry&lt;/a&gt;
than you can use everywhere, like
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/GeometryUtils.js&quot;&gt;GeometryUtils&lt;/a&gt;
or
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/objects/Mesh.js&quot;&gt;Mesh&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;Let's assemble&lt;/h2&gt;

&lt;p&gt;Now the fun part, lets assemble objects with those misterious
&lt;a href=&quot;http://en.wikipedia.org/wiki/Algebra_of_sets&quot;&gt;boolean operations&lt;/a&gt;
on ours
&lt;a href=&quot;http://evanw.github.com/csg.js/&quot;&gt;csg.js&lt;/a&gt;
geometries.
There are &lt;a href=&quot;http://en.wikipedia.org/wiki/Constructive_solid_geometry&quot;&gt;3 of them&lt;/a&gt;:
&lt;a href=&quot;http://en.wikipedia.org/wiki/Complement_(set_theory)&quot;&gt;difference&lt;/a&gt;,
&lt;a href=&quot;http://en.wikipedia.org/wiki/Union_(set_theory)&quot;&gt;union&lt;/a&gt;
and
&lt;a href=&quot;http://en.wikipedia.org/wiki/Intersection_(set_theory)&quot;&gt;intersect&lt;/a&gt;.
To build our dice, first we build a
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/geometries/CubeGeometry.js&quot;&gt;cube&lt;/a&gt;
then we subtract a bunch of
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/geometries/SphereGeometry.js&quot;&gt;spheres&lt;/a&gt;
to makes the holes.&lt;/p&gt;

&lt;p&gt;&lt;img class='right ' src='http://learningthreejs.com/data/constructive-solid-geometry-with-csg-js/images/image-substract-320x240.png' width='' height='' alt='' title=''&gt;&lt;/p&gt;

&lt;p&gt;Once you converted your objects, you apply operations on them.
For the dice, we use &lt;code&gt;.subtract()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cube.substract(spheres)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;div style=&quot;clear:both;&quot;&gt;&lt;/div&gt;


&lt;p&gt;&lt;img class='right ' src='http://learningthreejs.com/data/constructive-solid-geometry-with-csg-js/images/image-union-320x240.png' width='' height='' alt='' title=''&gt;&lt;/p&gt;

&lt;p&gt;But it is possible to use &lt;code&gt;.union()&lt;/code&gt; to add them.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cube.union(spheres)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Or to keep only the common part of both objects with &lt;code&gt;.intersect()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img class='right ' src='http://learningthreejs.com/data/constructive-solid-geometry-with-csg-js/images/image-intersect-320x240.png' width='' height='' alt='' title=''&gt;&lt;/p&gt;

&lt;p&gt;You can chain those operations to your own taste.
Up to you to be creative :)&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cube.intersect(spheres)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Constructive_solid_geometry&quot;&gt;Constructive solid Geometry&lt;/a&gt;
is simple and quite powerfull.
&lt;a href=&quot;http://evanw.github.com/csg.js/&quot;&gt;csg.js&lt;/a&gt;
,
&lt;a href=&quot;http://chandler.prallfamily.com/2011/12/constructive-solid-geometry-with-three-js/&quot;&gt;ThreeCSG.js&lt;/a&gt;
and
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;
makes it real easy to play with.
You may look at the source of our dice
&lt;a href=&quot;http://learningthreejs.com/data/constructive-solid-geometry-with-csg-js/&quot;&gt;demo&lt;/a&gt;
to see a working version of this code.
That's all for today, have fun :)&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Lets Make a 3D Game: Make It Embedded</title>
    <link href="http://learningthreejs.com/blog/2011/11/21/lets-make-a-3d-game-make-it-embedded/"/>
    <updated>2011-11-21T16:32:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2011/11/21/lets-make-a-3d-game-make-it-embedded</id>
    <content type="html">&lt;iframe src=&quot;http://marblesoccer.com&quot;
    allowfullscreen webkitallowfullscreen mozallowfullscreen
    width=&quot;420&quot; height=&quot;315&quot; frameborder=&quot;0&quot; style=&quot;float: right; margin-left: 1em;&quot;&gt;
&lt;/iframe&gt;


&lt;p&gt;This post is part of the &lt;a href=&quot;http://learningthreejs.com/blog/categories/tutorial3dgame/&quot;&gt;&quot;Let's make a 3D game&quot;&lt;/a&gt; series.
The previous post was on
&lt;a href=&quot;http://learningthreejs.com/blog/2011/11/17/lets-make-a-3d-game-make-it-fullscreen/&quot;&gt;fullscreen API&lt;/a&gt;.
Here is another one on resizing the display area.
This post is about embedding your game in another page.
It is usefull to include it in a blog, in facebook, iGoogle or other game plateforms.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://marblesoccer.com&quot;&gt;MarbleSoccer&lt;/a&gt;
now contains all the tricks explained in this post.
&lt;em&gt;Show dont tell&lt;/em&gt;, you can see it embedded on the left.
Embedding your game implies various things.
As your game is hosted in another page, it likely got a smaller display area.
HTML5
&lt;a href=&quot;http://www.w3.org/TR/css3-mediaqueries/&quot;&gt;CSS media query&lt;/a&gt;
makes it easy to fit various sizes.
Another part are the
&lt;a href=&quot;http://en.wikipedia.org/wiki/DOM_events&quot;&gt;DOM events&lt;/a&gt;
from the iframe.
They will be propagated to the host page and may produce undesirable effects.
We see how to shield them.
But first let's see about
&lt;a href=&quot;http://en.wikipedia.org/wiki/HTML_element#Frames&quot;&gt;iframe&lt;/a&gt;&lt;/p&gt;

&lt;h2&gt;Let's go play in an iframe&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/HTML_element#Frames&quot;&gt;iframe&lt;/a&gt;
is an easy and secure way to embed a page in another.
Let's declare it.&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;iframe src=&quot;http://marblesoccer.com&quot;
    allowfullscreen webkitallowfullscreen mozallowfullscreen
    width=&quot;480&quot; height=&quot;320&quot; frameborder=&quot;0&quot;&amp;gt;
&amp;lt;/iframe&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;!-- more --&gt;


&lt;p&gt;The attributes are pretty classics: &lt;code&gt;frameborder&lt;/code&gt; to remove an ugly default border,
&lt;code&gt;width&lt;/code&gt; and &lt;code&gt;height&lt;/code&gt; for size and &lt;code&gt;src&lt;/code&gt; for your game page.
The ones ending with &lt;code&gt;allowfullscreen&lt;/code&gt; tell the browser that this iframe is
allowed to go fullscreen. More about fullscreen in this
&lt;a href=&quot;http://learningthreejs.com/blog/2011/11/17/lets-make-a-3d-game-make-it-fullscreen/&quot;&gt;previous post&lt;/a&gt;
or in the &lt;a href=&quot;http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html&quot;&gt;spec&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;You may need to determined if your game is embedded or not.
Use this line will tell if it is in a iframe or not.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var isInIframe  = (window != window.top);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;Fit in a smaller display area&lt;/h2&gt;

&lt;p&gt;When your game is embedded, it is likely to have a smaller display area.
How to deal with this ?
First, we have 2 types of rendering in our game:
a 3D display where
&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt;
displays the
&lt;a href=&quot;http://en.wikipedia.org/wiki/WebGL&quot;&gt;WebGL&lt;/a&gt;, and
a DOM display for
&lt;a href=&quot;http://en.wikipedia.org/wiki/On-screen_display&quot;&gt;OSD&lt;/a&gt;
such as score, timers and other popups.&lt;/p&gt;

&lt;p&gt;For &lt;em&gt;3D rendering&lt;/em&gt;, we have already seen window resizing in
&lt;a href=&quot;http://learningthreejs.com/blog/2011/08/30/window-resize-for-your-demos/&quot;&gt;this post&lt;/a&gt;.
Just download
&lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.WindowResize.js&quot;&gt;THREEx.WindowResize&lt;/a&gt;
and add this line and you are done. Not too hard, hey.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;THREEx.WindowResize(renderer, camera);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Now &lt;em&gt;the DOM display&lt;/em&gt;. It may simply be done via CSS
and
&lt;a href=&quot;http://www.w3.org/TR/css3-mediaqueries/&quot;&gt;media queries&lt;/a&gt;.
Typically, you may reduce the size of your font or icons.
I won't try to teach css, other do that much
&lt;a href=&quot;https://developer.mozilla.org/en/CSS/Media_queries&quot;&gt;better&lt;/a&gt;
&lt;a href=&quot;http://www.html5rocks.com/en/mobile/mobifying.html#toc-mediaqueries&quot;&gt;than&lt;/a&gt;
&lt;a href=&quot;http://thinkvitamin.com/code/media-queries-width-and-height-video-tutorial/&quot;&gt;me&lt;/a&gt;.
Just a pick of what i did, not sure at all it is the best way.
I reduce the OSD display if your game page is 640px or less.&lt;/p&gt;

&lt;p&gt;```css&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;@media all and (max-width: 640px) {
    /* here put your style specific for embedded case */
    body { font-size : 60%; }
    img { width : 48px; }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;Shield Events&lt;/h2&gt;

&lt;p&gt;Strange section title, hey.
It means &lt;em&gt;prevents DOM events from the iframe to interfere with the host page&lt;/em&gt;.
Not much clearer...
Maybe with an example ? Let's see the arrows+scroll case.
Show dont tell.
Below are 2 iframes: on the left, no shielding happens, on the right shielding happens.
Try to click on them and use arrows up/down.&lt;/p&gt;

&lt;iframe src=&quot;http://learningthreejs.com/data/THREEx/examples/threex.embedded/noshield-iframe.html&quot; width='50%' height='120px'&gt;&lt;/iframe&gt;


&lt;iframe src=&quot;http://learningthreejs.com/data/THREEx/examples/threex.embedded/withshield-iframe.html&quot; width='49%' height='120px'&gt;&lt;/iframe&gt;


&lt;p&gt;On the left, the host page scrolls, but not on the right.
Why does this happen ? good question :)
If our game iframe got the focus and users press up or down, the iframe will received
&lt;a href=&quot;http://www.quirksmode.org/dom/events/keys.html&quot;&gt;keydown/keyup events&lt;/a&gt;.
Up to now, all is ok...
Troubles appear when those events are bubbling to the host page, they may trigger a scrolling.&lt;/p&gt;

&lt;p&gt;Imagine the page going up and down while you play, the game becomes unplayable very fast :)
So here is the code which prevents this behavior. It listens to arrows
&lt;a href=&quot;http://www.quirksmode.org/dom/events/keys.html&quot;&gt;keydown events&lt;/a&gt;.
and prevent their default.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;document.addEventListener('keydown', function(event){
    // if it is keydown on a arrow, prevent default
    if( event.keyCode &amp;gt;= 37 &amp;amp;&amp;amp; event.keyCode &amp;lt;= 40 ){
        event.preventDefault();
    }
}, true);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;I gathered the code in
&lt;a href=&quot;http://learningthreejs.com/data/THREEx/threex.embedded.js&quot;&gt;threex.embedded&lt;/a&gt;,
see its
&lt;a href=&quot;http://learningthreejs.com/data/THREEx/docs/threex.embedded.html&quot;&gt;annoted source&lt;/a&gt;.
Iframe is a easy and secure way to make your game embeddable.
We have seen how to handle smaller display area
with
&lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.WindowResize.js&quot;&gt;THREEx.WindowResize&lt;/a&gt;
and
&lt;a href=&quot;http://www.w3.org/TR/css3-mediaqueries/&quot;&gt;media queries&lt;/a&gt;.
Additionnaly we even shield DOM events, so we can use arrow keys for player control.
You are all set! Go embed your game now :)&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Lets Make a 3D Game: Make It Fullscreen</title>
    <link href="http://learningthreejs.com/blog/2011/11/17/lets-make-a-3d-game-make-it-fullscreen/"/>
    <updated>2011-11-17T07:59:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2011/11/17/lets-make-a-3d-game-make-it-fullscreen</id>
    <content type="html">&lt;p&gt;This post is part of the &lt;a href=&quot;http://learningthreejs.com/blog/categories/tutorial3dgame/&quot;&gt;&quot;Lets make a 3D game&quot;&lt;/a&gt; series.
It is about the &lt;a href=&quot;http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html&quot;&gt;fullscreen API&lt;/a&gt;.
This API allows to make DOM elements fullscreen.
Fullscreen is quite important for games.
It provides a larger display so a more immersive experience for your players.
All that from javascript, so no more needed to ask &quot;please f11&quot; to your
players, isnt that sweet ? :)&lt;/p&gt;

&lt;p&gt;&lt;img class='right ' src='http://learningthreejs.com/data/lets-make-a-3d-game-make-it-fullscreen/images/fullscreen-icon.png' width='' height='' alt='' title=''&gt;&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html&quot;&gt;fullscreen API&lt;/a&gt;
is still in discussion, but the basics are settled. At the time of this writing,
it is available in
&lt;a href=&quot;http://blog.pearce.org.nz/2011/11/firefoxs-html-full-screen-api-enabled.html&quot;&gt;firefox nightly&lt;/a&gt;,
&lt;a href=&quot;http://peter.sh/2011/01/javascript-full-screen-api-navigation-timing-and-repeating-css-gradients/&quot;&gt;webkit nightly&lt;/a&gt;and
&lt;a href=&quot;http://updates.html5rocks.com/2011/10/Let-Your-Content-Do-the-Talking-Fullscreen-API&quot;&gt;chrome stable&lt;/a&gt;.
It has been already added in &lt;a href=&quot;http://marblesoccer.com&quot;&gt;marbleSoccer&lt;/a&gt;.
The icon is from &lt;a href=&quot;http://thenounproject.com/&quot;&gt;The Noun Project&lt;/a&gt;, a source of nice and clean icons.
Try it out! Click on it to toggle fullscreen state. If you dont see the icon, your browser
doesn't yet have the fullscreen API.&lt;/p&gt;

&lt;center&gt;
    &lt;iframe webkitallowfullscreen mozallowfullscreen allowfullscreen width=&quot;100%&quot; height=&quot;320&quot; src=&quot;http://marblesoccer.com&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;
&lt;/center&gt;


&lt;p&gt;Ok now is time for code :)&lt;/p&gt;

&lt;h2&gt;Let's get started&lt;/h2&gt;

&lt;p&gt;As usual, i provide a little helper to make it easier for you to include it in
your games. It is called &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.FullScreen.js&quot;&gt;THREEx.FullScreen.js&lt;/a&gt;.
It hides the prefix of each vendor and the little discrepencies between their API
implementation.
You download this file from &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.FullScreen.js&quot;&gt;here&lt;/a&gt; and include
it in your page like this&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src='THREEx.FullScreen.js'&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;How to use it ?&lt;/h2&gt;

&lt;p&gt;The API is simple, only 4 calls. Lets see them one by one.
To test if it is possible to have fullscreen on your system, do&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;THREEx.FullScreen.available();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;To test if fullscreen is currently activated on your page&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;THREEx.FullScreen.activated();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;To Request fullscreen on a given element, just do&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;THREEx.FullScreen.request(element);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;If element isnt provided, it defaults to &lt;code&gt;document.body&lt;/code&gt;.
To cancel fullscreen on your page, use this line.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;THREEx.FullScreen.cancel();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Quite straight forward, no ? :) As an example, let's make a toggle, the same used
in &lt;a href=&quot;http://marblesoccer.com&quot;&gt;marbleSoccer&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;if( THREEx.FullScreen.activated() ){
    THREEx.FullScreen.cancel();
}else{
    THREEx.FullScreen.request();
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;What about the standard ?&lt;/h2&gt;

&lt;p&gt;There is a &lt;a href=&quot;http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html&quot;&gt;w3c proposal&lt;/a&gt; in dicussion.
John dyer has written an in-depth &lt;a href=&quot;http://johndyer.name/native-fullscreen-javascript-api-plus-jquery-plugin/&quot;&gt;summary&lt;/a&gt;.
Mozilla provides details on &lt;a href=&quot;https://wiki.mozilla.org/Gecko:FullScreenAPI&quot;&gt;their API&lt;/a&gt;.
At the time of this writing
It is available in
&lt;a href=&quot;http://blog.pearce.org.nz/2011/11/firefoxs-html-full-screen-api-enabled.html&quot;&gt;firefox nightly&lt;/a&gt;,
&lt;a href=&quot;http://peter.sh/2011/01/javascript-full-screen-api-navigation-timing-and-repeating-css-gradients/&quot;&gt;webkit nightly&lt;/a&gt;
and
&lt;a href=&quot;http://updates.html5rocks.com/2011/10/Let-Your-Content-Do-the-Talking-Fullscreen-API&quot;&gt;chrome stable&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;For more details on &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.FullScreen.js&quot;&gt;THREEx.FullScreen&lt;/a&gt;,
see its &lt;a href=&quot;http://learningthreejs.com/data/THREEx/docs/THREEx.FullScreen.html&quot;&gt;annoted source&lt;/a&gt;.
It is a simple to add in your game.
It provides a more immersive experience to your players.
On a related subject, we will soon likely do a post about embedding your game in another page.
It is usefull when you want to include it in a blog, in facebook or other game plateforms.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Lets Make a 3D Game: microphysics.js, even easier</title>
    <link href="http://learningthreejs.com/blog/2011/11/02/lets-make-a-3d-game-helper-for-microphysics-js/"/>
    <updated>2011-11-02T18:16:00+01:00</updated>
    <id>http://learningthreejs.com/blog/2011/11/02/lets-make-a-3d-game-helper-for-microphysics-js</id>
    <content type="html">&lt;p&gt;This post is part of the &lt;a href=&quot;http://learningthreejs.com/blog/categories/tutorial3dgame/&quot;&gt;&quot;Lets make a 3D game&quot;&lt;/a&gt; series.
It is a follow up from the previous article on &lt;a href=&quot;http://learningthreejs.com/blog/2011/10/17/lets-make-a-3d-game-microphysics-js/&quot;&gt;microphysics.js&lt;/a&gt;.
It will describe how to easily include &lt;strong&gt;microphysics.js&lt;/strong&gt; in your three.js games.
&lt;a href=&quot;https://raw.github.com/jeromeetienne/microphysics.js/master/THREEx.microphysics.js&quot;&gt;THREEx.microphysics.js&lt;/a&gt; is a THREEx wrapper for microphysics.js.
It helps binding &lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt; objects to &lt;a href=&quot;http://learningthreejs.com/blog/2011/10/17/lets-make-a-3d-game-microphysics-js/&quot;&gt;microphysics.js&lt;/a&gt;.
The API is chained for convenience.&lt;/p&gt;

&lt;h2&gt;Let's get started&lt;/h2&gt;

&lt;p&gt;So lets see how to use it.
First step, you download it
&lt;a href=&quot;https://raw.github.com/jeromeetienne/microphysics.js/master/THREEx.microphysics.js&quot;&gt;here&lt;/a&gt;.
Then include it in your own code with this line.&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src=&quot;THREEx.microphysics.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;Initialisation&lt;/h2&gt;

&lt;p&gt;You instanciate the physics engine, like that.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var microphysics = new THREEx.Microphysics(opts);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;&lt;code&gt;opts&lt;/code&gt; is optional.
&lt;code&gt;opts.timeStep&lt;/code&gt; controls the frequency of the world update.
The smaller it is the more accurate is the physics but the longer it is to compute.
It defaults to &lt;code&gt;1/60&lt;/code&gt;. Once instanciated, you start it.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;microphysics.start();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;Binding THREE.Mesh&lt;/h2&gt;

&lt;p&gt;Of course we need to add some mesh in the world. After this line, the &lt;code&gt;mesh&lt;/code&gt;
is bound to microphysics.js, so its position is driven by the physics.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;microphysics.bindMesh(mesh, opts);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;&lt;code&gt;mesh.position&lt;/code&gt; is honored.
If you need to unbind a &lt;code&gt;mesh&lt;/code&gt;, just do&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;microphysics.unbindMesh(mesh);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;At the time of this writing, microphysics.js support only moving sphere and static
boxes, so geometry may only be &lt;code&gt;THREE.SphereGeometry&lt;/code&gt; or &lt;code&gt;THREE.CubeGeometry&lt;/code&gt;.
If your mesh got another geometry, use &lt;code&gt;opts.geometry&lt;/code&gt; to say how you wish the mesh
to be handled.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;microphysics.bindMesh(mesh, {
     geometry   : new THREE.CubeGeometry(200,200,200);
});
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;It is also possible to overwrite &lt;code&gt;Mesh.position&lt;/code&gt; with &lt;code&gt;opts.position&lt;/code&gt;, or
to send options directly to microphysics.js with &lt;code&gt;opts.physics&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;microphysics.bindMesh(mesh, {
    // to overwrite the Mesh.position
    position    : { x : 1, y : 1, z : 2 },
    // to pass options directly to microphysics.js
    physics     : { restitution : 0.98 }
});
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;Updating the physics&lt;/h2&gt;

&lt;p&gt;In your render loop, just add this line. It will first update the physics world and
then move accordingly any &lt;code&gt;THREE.Mesh&lt;/code&gt; you bound.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;microphysics.update();  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;Needs a Direct Access ?&lt;/h2&gt;

&lt;p&gt;If you need to have direct access to microphysics.js, uses
&lt;code&gt;microphysics.body(mesh)&lt;/code&gt; to get the &lt;code&gt;vphy.Body&lt;/code&gt; bound to &lt;code&gt;mesh&lt;/code&gt;.
To access &lt;code&gt;vphy.World&lt;/code&gt;, just use &lt;code&gt;microphysics.word()&lt;/code&gt;.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;In the previous article on &lt;a href=&quot;http://learningthreejs.com/blog/2011/10/17/lets-make-a-3d-game-microphysics-js/&quot;&gt;microphysics.js&lt;/a&gt;,
we learned how to use microphysics.js directly. This article makes it really easy to include
in your &lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt; demo/game.
It is so nice that it is what is used in the
&lt;a href=&quot;http://jeromeetienne.github.com/microphysics.js/playground/&quot;&gt;playground&lt;/a&gt;.
That's all for today folks. Have fun :)&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Lets Make a 3D Game: microphysics.js</title>
    <link href="http://learningthreejs.com/blog/2011/10/17/lets-make-a-3d-game-microphysics-js/"/>
    <updated>2011-10-17T12:36:00+02:00</updated>
    <id>http://learningthreejs.com/blog/2011/10/17/lets-make-a-3d-game-microphysics-js</id>
    <content type="html">&lt;p&gt;This post is part of the &lt;a href=&quot;http://learningthreejs.com/blog/categories/tutorial3dgame/&quot;&gt;&quot;Lets make a 3D game&quot;&lt;/a&gt; series.
3D and physics simulation always go well together
&lt;a href=&quot;http://www.youtube.com/watch?v=Rd7TyU9RdQk&quot;&gt;even&lt;/a&gt;
&lt;a href=&quot;http://www.youtube.com/watch?v=o_xr8Htj9GI&quot;&gt;more&lt;/a&gt;
&lt;a href=&quot;http://www.youtube.com/watch?v=Xfrzi-yVcsM&quot;&gt;so&lt;/a&gt;
&lt;a href=&quot;http://www.youtube.com/watch?v=uvCbc8vFUMo&quot;&gt;with&lt;/a&gt;
&lt;a href=&quot;http://www.youtube.com/watch?v=7lBUBBW_sF0&quot;&gt;marble&lt;/a&gt;
&lt;a href=&quot;http://www.youtube.com/watch?v=c7npJ3E-ydA&quot;&gt;games&lt;/a&gt;.
One is required for &lt;a href=&quot;http://marblesoccer.com&quot;&gt;marblesoccer&lt;/a&gt; but i wasnt
convinced by current 3d physics engines. I explain why at the end.
Fortunatly, &lt;a href=&quot;http://twitter.com/#!/pyalot&quot;&gt;@pyalot&lt;/a&gt; from &lt;a href=&quot;http://codeflow.org/&quot;&gt;codeflow.org&lt;/a&gt;
has been kind enough to write one taylor-made for us: &lt;strong&gt;microphysics.js&lt;/strong&gt;!!&lt;/p&gt;

&lt;p&gt;It is bite-sized, elegant and efficient.
Less than 500 lines at the moment!!
It is small engouh to be understood, important feature for a tutorial blog.
It is a work in progress tho.
We aren't aware of any bugs.
New features will be added and the API is expected to move.
Currently it implements moving spheres and static boxes (or &lt;a href=&quot;http://en.wikipedia.org/wiki/Axis-aligned_bounding_box&quot;&gt;AABB&lt;/a&gt; as we like to say).
This is all we need for &lt;a href=&quot;http://marblesoccer.com&quot;&gt;marblesoccer&lt;/a&gt;, the good thing about tailor-made.
&lt;em&gt;We are in business!!!&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Below is a screencast of me doing a short introduction of the
&lt;a href=&quot;http://jeromeetienne.github.com/microphysics.js/playground/&quot;&gt;playground&lt;/a&gt;.
This just a page for you to experiment with microphysics.js.&lt;/p&gt;

&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/DI5PV2_sLoM&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;


&lt;h2&gt;Let's get started&lt;/h2&gt;

&lt;p&gt;So lets see how to use it.
First step, you download it &lt;a href=&quot;https://raw.github.com/jeromeetienne/microphysics.js/master/codeflow/physics.js&quot;&gt;here&lt;/a&gt;.
Then include it in your own code with this line.&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src=&quot;physics.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;Let's Create a World&lt;/h2&gt;

&lt;p&gt;&lt;img class='right ' src='http://learningthreejs.com/data/lets-make-a-3d-game-microphysics-js/images/galactus.png' width='' height='' alt='' title=''&gt;&lt;/p&gt;

&lt;p&gt;Quite a title hey ?
Dont you feel like &lt;a href=&quot;http://en.wikipedia.org/wiki/Galactus&quot;&gt;galactus&lt;/a&gt; when you say it ?
First you instanciate the physics &lt;code&gt;world&lt;/code&gt; like this.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var world = new vphy.World()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Now you start it. Dont forget to give it the date as you see it.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;world.start(Date.now()/1000);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;world&lt;/code&gt; is now fully initialized.
You just have to periodically update it in your game/render loop.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var timeStep    = 1/180;
world.step(timeStep, Date.now()/1000);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;timeStep&lt;/code&gt; parameter is the precision of the physics engine, expressed in seconds.
Quite a subtle tradeoff.
The smaller it is, the more accurate is the physics, but the slower it is to compute.
Up to you to find the balance that fit your needs.&lt;/p&gt;

&lt;h2&gt;Let's Add Bodies&lt;/h2&gt;

&lt;p&gt;&lt;img class='left ' src='http://learningthreejs.com/data/lets-make-a-3d-game-microphysics-js/images/The_shining_heres_johnny.jpg' width='' height='' alt='' title=''&gt;&lt;/p&gt;

&lt;p&gt;Don't worry, this is not about killing people and dispose of their dead bodies :)
In physics, A &lt;a href=&quot;http://en.wikipedia.org/wiki/Rigid_body&quot;&gt;body&lt;/a&gt; is a solid object that you put in your world.
microphysics bodies can be spheres or static boxes.
Lets start right away by creating a sphere.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var sphere  = new vphy.Sphere({
    x : 10,
    y : 10,
    z : 10,
    restitution : 0.6,
    radius : 5,
});
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;This will position it at &lt;code&gt;(10,10,10)&lt;/code&gt; in the world.
&lt;a href=&quot;http://en.wikipedia.org/wiki/Coefficient_of_restitution&quot;&gt;restitution&lt;/a&gt; will determine how
bouncy is this during a collision.
A bouncing ball restitutes a lot.
A falling eggs restitutes less :)
This declaration seems quite verbose at first.
Don't worry those parameters got sensible defaults, no need to specify them all.&lt;/p&gt;

&lt;p&gt;Now lets add it to our world&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;world.add(sphere);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;If you need to remove it, just do &lt;code&gt;world.remove(sphere)&lt;/code&gt;. Not too hard hey ?
Now lets create a static box.
Boxes are called &lt;em&gt;AABB&lt;/em&gt;.
It stands for &lt;a href=&quot;http://en.wikipedia.org/wiki/Axis-aligned_bounding_box&quot;&gt;Axis-aligned bounding box&lt;/a&gt;.
It is graphic jarguon for the smallest box containing your object.
&lt;code&gt;vphy.Sphere&lt;/code&gt;and &lt;code&gt;vphy.AABB&lt;/code&gt; both derived from &lt;code&gt;vphy.Body&lt;/code&gt;.
&lt;code&gt;x, y, z, resitution&lt;/code&gt; are &lt;code&gt;vphy.Body&lt;/code&gt; parameters, common to both.
So we wont review them again.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var body = new vphy.AABB({
    width : 1,
    height: 1,
    depth : 1
});
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;&lt;code&gt;width&lt;/code&gt;, &lt;code&gt;height&lt;/code&gt; and &lt;code&gt;depth&lt;/code&gt; gives the dimensions of the box.
After &lt;code&gt;world.step()&lt;/code&gt;, you can read the new position of each body. Quite usefull
to push back the resulting physics in your 3D scene :)&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var pos = body.getPosition();   // x = pos[0], y = pos[1], z = pos[2]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Ok, so we got a &lt;code&gt;world&lt;/code&gt; with solid objects in it, all bound to &lt;a href=&quot;http://en.wikipedia.org/wiki/Physical_law&quot;&gt;physical law&lt;/a&gt;.
Now what about moving them ?&lt;/p&gt;

&lt;h2&gt;Let's move our Bodies&lt;/h2&gt;

&lt;p&gt;&lt;img class='right ' src='http://learningthreejs.com/data/lets-make-a-3d-game-microphysics-js/images/aerobic-small.jpg' width='' height='' alt='' title=''&gt;&lt;/p&gt;

&lt;p&gt;Lets make our sphere moves.
The bodies you added to the world will move according to the &lt;a href=&quot;http://en.wikipedia.org/wiki/Force&quot;&gt;forces&lt;/a&gt; applied on them.
All that according to
&lt;a href=&quot;http://en.wikipedia.org/wiki/Newton%27s_laws_of_motion&quot;&gt;laws of motion&lt;/a&gt;
from &lt;a href=&quot;http://en.wikipedia.org/wiki/Isaac_Newton&quot;&gt;Newton&lt;/a&gt;.
He discovered that by receiving an &lt;a href=&quot;http://en.wikipedia.org/wiki/Isaac_Newton#Apple_analogy&quot;&gt;apple on the head&lt;/a&gt;,
creativity can take strange paths sometime :)&lt;/p&gt;

&lt;p&gt;Ok let's add &lt;a href=&quot;http://en.wikipedia.org/wiki/Gravity_of_Earth&quot;&gt;gravity&lt;/a&gt;, the force which moved this falling apple.
This force is applied along a given direction to all our objects.
The library already contains an helper just for that. Simply do&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;world.add(new vphy.LinearAccelerator({
    x   :  0, 
    y   : -9.8,
    z   :  0
}));
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Quite easy, no? Now lets see a custom accelerator, for example a player moving
according to the keyboard. The player will be a &lt;code&gt;vphy.Sphere&lt;/code&gt; and we will
reuse the &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.KeyboardState.js&quot;&gt;keyboard helper&lt;/a&gt; we
did in this &lt;a href=&quot;http://learningthreejs.com/blog/2011/09/12/lets-Make-a-3D-game-keyboard/&quot;&gt;post&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var player  = new vphy.Sphere({ radius : 20 });
world.add({
    type: vphy.types.ACCELERATOR,   // let the lib know it is an accelerator
    perform: function(bodies){      // bodies is the array of all vphy.Body
        if( keyboard.pressed('right') ) player.accelerate(1,0,0);
        if( keyboard.pressed('left') )  player.accelerate(-1,0,0);
        if( keyboard.pressed('up') )    player.accelerate(0,0,1);
        if( keyboard.pressed('down') )  player.accelerate(0,0,-1);
    }
});
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;&lt;code&gt;.perform()&lt;/code&gt; will be called at every world step.
It accesses &lt;code&gt;player&lt;/code&gt; via
&lt;a href=&quot;https://developer.mozilla.org/en/JavaScript/Guide/Closures&quot;&gt;closure&lt;/a&gt;
, read current keyboard state and accelerate in the proper direction.&lt;/p&gt;

&lt;h2&gt;Motivation&lt;/h2&gt;

&lt;p&gt;The need for 3D physics is clear for &lt;a href=&quot;http://marblesoccer.com&quot;&gt;marblesoccer&lt;/a&gt;.
Marble in physics are fun, generic and instinctive for the player.
Ok so how to get a 3D physics engine ?&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Do it yourself ? &lt;/strong&gt;
Well no, it is hard, long and im lazy :)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Use an existing one ? &lt;/strong&gt;
i tried some and left unimpressed. All those are new experimental stuff.
Documentation is inexistant.
They are issued from existing libraries in other languages and convert them to js, sometime multiple conversions in a row.
I experienced major bugs when i tried. Were those bugs ? Was it me misusing it ?
Quite possible as the doc is inexistant.
All in all, i didnt feel it would be a reliable dependancy for our game.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Used a 2D one, like Box2D ? &lt;/strong&gt;
Box2D is kind of special.
&lt;a href=&quot;http://blog.sethladd.com/&quot;&gt;Seth Ladd&lt;/a&gt; recently did
&lt;a href=&quot;http://blog.sethladd.com/2011/09/box2d-collision-damage-for-javascript.html&quot;&gt;a&lt;/a&gt;
&lt;a href=&quot;http://blog.sethladd.com/2011/09/box2d-impulse-and-javascript.html&quot;&gt;lot&lt;/a&gt;
&lt;a href=&quot;http://blog.sethladd.com/2011/09/box2d-with-complex-and-concave-objects.html&quot;&gt;of&lt;/a&gt;
&lt;a href=&quot;http://blog.sethladd.com/2011/09/box2d-and-polygons-for-javascript.html&quot;&gt;good&lt;/a&gt;
&lt;a href=&quot;http://blog.sethladd.com/2011/09/box2d-web-workers-better-performance.html&quot;&gt;things&lt;/a&gt;
to explain box2D. Ok, box2D is a converted one but it is of very good quality.
So why not using box2D ?
Well because it is 2D and we do 3D.
Quite an insight, hey :)
It would be such a tough limitation.
This webgl + box2D strategy can produce excelent results tho, like this
&lt;a href=&quot;http://game.2x.io/&quot;&gt;game demo&lt;/a&gt; from &lt;a href=&quot;http://twitter.com/#!/einaros&quot;&gt;@einaros&lt;/a&gt;.
Take a close look at the physics when object move, it is amazingly
realistic and it is all box2D.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Ask somebody else to do it ? &lt;/strong&gt;
We got a &lt;em&gt;winner!&lt;/em&gt; &lt;a href=&quot;http://twitter.com/#!/pyalot&quot;&gt;@pyalot&lt;/a&gt; from &lt;a href=&quot;http://codeflow.org/&quot;&gt;codeflow.org&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h2&gt;Credits&lt;/h2&gt;

&lt;p&gt;All images are from &lt;a href=&quot;http://en.wikipedia.org&quot;&gt;wikipedia&lt;/a&gt;. All hard work is from &lt;a href=&quot;http://twitter.com/#!/pyalot&quot;&gt;@pyalot&lt;/a&gt;&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;This is the first post about physics.
It presented microphysics.js API.
Thus you can start playing with it immediatly.
More posts will come shortly.
At least, one about performance and another one on how to easily bind microphysics to your three.js game.
That's all folks.
Have fun with microphysics.js :)&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Performance: Merging Geometry</title>
    <link href="http://learningthreejs.com/blog/2011/10/05/performance-merging-geometry/"/>
    <updated>2011-10-05T11:29:00+02:00</updated>
    <id>http://learningthreejs.com/blog/2011/10/05/performance-merging-geometry</id>
    <content type="html">&lt;p&gt;This article is about merging geometry and how it can improve performance.
It is important for perfomance to reduce the number of &lt;a href=&quot;http://www.khronos.org/registry/webgl/specs/latest/&quot;&gt;WebGL&lt;/a&gt; calls as much as possible.
The rules of thumbs is &lt;em&gt;the less data are exchanged between the cpu and the gpu, the better it is for performance&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;http://learningthreejs.com/data/performance-merging-geometry/&quot;&gt;demo&lt;/a&gt; is rendering many cubes and put them randomly in the space.
&lt;img class='left ' src='http://learningthreejs.com/data/performance-merging-geometry/images/demo-screenshot-2000.png' width='240' height='120' alt='' title=''&gt;
&lt;img class='right ' src='http://learningthreejs.com/data/performance-merging-geometry/images/demo-screenshot-120000.png' width='240' height='120' alt='' title=''&gt;
It is a simplictic way to measure the performance, but it will do for us.
If the geometries arent merged, my computer is able to display &lt;em&gt;2000&lt;/em&gt; cubes at 30fps. See on the left.
But if the geometry are merged, it displays &lt;em&gt;120000&lt;/em&gt; cubes at 30fps. See on the right.
Screenshots make it pretty obvious :) This is &lt;strong&gt;60 times&lt;/strong&gt; more cubes!!!&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;So Let's Merge Geometries&lt;/h2&gt;

&lt;p&gt;A geometry is the shape of the 3D object. three.js got already
&lt;a href=&quot;https://github.com/mrdoob/three.js/tree/master/src/extras/geometries&quot;&gt;several predefined&lt;/a&gt; for you.
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/geometries/PlaneGeometry.js&quot;&gt;plane&lt;/a&gt;,
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/geometries/CubeGeometry.js&quot;&gt;cube&lt;/a&gt; or
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/geometries/SphereGeometry.js&quot;&gt;sphere&lt;/a&gt;
are the common ones.
This post is about merging them, so lets do that.
This line will merge &lt;code&gt;otherGeometry&lt;/code&gt; into &lt;code&gt;geometry&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;THREE.GeometryUtils.merge(geometry, otherGeometry);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;&lt;code&gt;THREE.GeometryUtils.merge()&lt;/code&gt; is in &lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/GeometryUtils.js&quot;&gt;THREE.GeometryUtils&lt;/a&gt; with other geometry related functions.
Btw it is more a concatenation than an actual merge them. No duplicate is removed in the process.&lt;/p&gt;

&lt;h2&gt;Combo: merging geometry with mesh&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;THREE.GeometryUtils.merge()&lt;/code&gt; supports to merge geometries with meshes too.
In this case, the function will honor the mesh position/orientation.
As a bonus, if your mesh uses &lt;code&gt;THREE.MeshFaceMaterial&lt;/code&gt;, materials will be copied along.
It is quite convenient when building a large geometry, or when optimising existing scenes with meshes.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var mesh = new THREE.Mesh(new THREE.CubeGeometry(10,10,10), new THREE.MeshNormalMaterial());
mesh.position.x = 30;
mesh.rotation.y = Math.PI/3;
THREE.GeometryUtils.merge(geometry, mesh);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;This will merge a &lt;code&gt;THREE.CubeGeometry&lt;/code&gt; with a translation of &lt;code&gt;30&lt;/code&gt; on &lt;code&gt;x&lt;/code&gt;
and a rotation of &lt;code&gt;Math.PI/3&lt;/code&gt; on &lt;code&gt;y&lt;/code&gt;.
Simple enougth hey ? what about Limitations ?&lt;/p&gt;

&lt;h2&gt;When to use it ?&lt;/h2&gt;

&lt;p&gt;The answer is &lt;em&gt;whenever possible&lt;/em&gt; due to the performance improvement.
The merged geometry will act as a single atomic shape.
So it is perfect with static geometry.
But it may not be suitable in all cases.
For example, it won't be possible to move the merged objects independantly from each other.
Or you can no more remove or add a object without recomputing the whole geometry.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;So merging geometry reduces the amount of webgl calls, so dramatically improve
performance (x60 time in our little demo). It is simple enougth to add to your
demos or games when they have large static geometries. So use it as much as possible.
That's all folks. I hope it has been usefull :)&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Let's Make a 3D Game: Device Orientation</title>
    <link href="http://learningthreejs.com/blog/2011/09/20/lets-make-a-3D-game-device-orientation/"/>
    <updated>2011-09-20T10:35:00+02:00</updated>
    <id>http://learningthreejs.com/blog/2011/09/20/lets-make-a-3D-game-device-orientation</id>
    <content type="html">&lt;p&gt;Here is another article of the &quot;Let's Make a 3D Game&quot; &lt;a href=&quot;http://learningthreejs.com/blog/categories/tutorial3dgame/&quot;&gt;series&lt;/a&gt;.
It is about &lt;strong&gt;device orientation&lt;/strong&gt;, another input you can use for your games.
We have already seen how to handle the &lt;a href=&quot;http://learningthreejs.com/blog/2011/09/12/lets-Make-a-3D-game-keyboard/&quot;&gt;keyboard&lt;/a&gt; input.
Device orientation input is more instinctive tho. The user doesnt need to learn controls.
It is already enabled in our game &lt;a href=&quot;http://marblesoccer.com&quot;&gt;marblesoccer&lt;/a&gt;.
Here is a &lt;a href=&quot;http://www.youtube.com/watch?v=kW4oHaHCilo&quot;&gt;video&lt;/a&gt; of me playing with it.&lt;/p&gt;

&lt;center&gt;
    &lt;iframe width=&quot;425&quot; height=&quot;349&quot; src=&quot;http://www.youtube.com/embed/kW4oHaHCilo&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
&lt;/center&gt;




&lt;!-- more --&gt;


&lt;p&gt;You need a computer which support WebGL &lt;em&gt;and&lt;/em&gt; device orientation to actually play
with it. Unfortunatly, macbook is the only computer i know able to do that.
On one hand, most smartphones already support &lt;em&gt;device orientation API&lt;/em&gt;.
On the other hand, smartphones support for WebGL is sparse at best.
So this input will become very usefull if we start supporting
&lt;a href=&quot;https://github.com/mrdoob/three.js/tree/master/src/renderers&quot;&gt;three.js renderers&lt;/a&gt;
available on phones, such as canvas or DOM.&lt;/p&gt;

&lt;h2&gt;Let's get started&lt;/h2&gt;

&lt;p&gt;As usual, i did a little helper to make it easier for you to include it in
your games. It is called &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.DeviceOrientationState.js&quot;&gt;THREEx.DeviceOrientationState&lt;/a&gt;.
You download this API from &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.DeviceOrientationState.js&quot;&gt;here&lt;/a&gt; and include
it in your page like this&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src='THREEx.DeviceOrientationState.js'&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;How to use it ?&lt;/h2&gt;

&lt;p&gt;Now that the script is included, create a &lt;code&gt;device&lt;/code&gt; variable like this.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var device = new THREEx.DeviceOrientationState();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;After that, if you want the angle the device with the x axis, just use
&lt;code&gt;.angleX()&lt;/code&gt; function. You can use &lt;code&gt;.angleY()&lt;/code&gt; and &lt;code&gt;.angleZ()&lt;/code&gt;, you
guessed which angle they provide.
Suppose you want a &lt;code&gt;THREE.Mesh&lt;/code&gt; to stay still on y axis while you are moving the device,
just copy this line&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mesh.rotation.y = device.angleY();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;If you ever want to stop listening to the device orientation, just use this line&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;device.destroy()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;What about the standard ?&lt;/h2&gt;

&lt;p&gt;Sometime it may be interesting to understand the root of things.
Let's do a rapid introduction of the device orientation API itself.
For authoritative details, the &lt;a href=&quot;http://www.w3.org/TR/orientation-event/&quot;&gt;spec&lt;/a&gt;
is always a nice place.
If you want more info on it, &lt;a href=&quot;http://www.html5rocks.com/en/tutorials/device/orientation/&quot;&gt;html5rocks&lt;/a&gt;
or &lt;a href=&quot;https://developer.mozilla.org/en/detecting_device_orientation&quot;&gt;mdn&lt;/a&gt;
articles are a good start.
First let's bind the event.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;window.addEventListener('deviceorientation',  callback, false);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Here is an example of callback&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;function callback(event){
    console.log(&quot;orientation gamma:&quot;, event.gamma, &quot;beta&quot;, event.beta, &quot;alpha&quot;, event.alpha);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Be carefull tho, gamma, beta, alpha may not be set depending on the device your game is
running on. For example on macbook, &lt;code&gt;alpha&lt;/code&gt; is always &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;For more details on &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.DeviceOrientationState.js&quot;&gt;THREEx.DeviceOrientationState&lt;/a&gt;,
see its &lt;a href=&quot;http://learningthreejs.com/data/THREEx/docs/THREEx.DeviceOrientationState.html&quot;&gt;annoted source&lt;/a&gt;.
It is a simple and instinctive way to control the player.
It is closer to real-life and thus provides a more immersive experience.
In the future we will likely do be
a &lt;a href=&quot;http://www.youtube.com/watch?v=-sEJ4Lo0cm8&quot;&gt;virtual joystick&lt;/a&gt; for touch enabled device.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Performance: Caching Material</title>
    <link href="http://learningthreejs.com/blog/2011/09/16/performance-caching-material/"/>
    <updated>2011-09-16T10:25:00+02:00</updated>
    <id>http://learningthreejs.com/blog/2011/09/16/performance-caching-material</id>
    <content type="html">&lt;p&gt;This article is about performance and how caching can improve them.
In WebGL, it is important not to push the same textures multiple times to the GPU.
It uselessly slow down the rendering.
As a rules of thumbs, the less data are exchanged between the cpu and the gpu, the better
it is for performance.&lt;/p&gt;

&lt;h2&gt;A Basic Caching&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/mrdoob/three.js/&quot;&gt;three.js&lt;/a&gt; handles cache cleanly and
eleguantly. If you instanciate
a javascript object
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/textures/Texture.js&quot;&gt;THREE.texture&lt;/a&gt;
or
a &lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/materials/Material.js&quot;&gt;THREE.Material&lt;/a&gt;
only once, it will be pushed only once to the GPU.
It is the simplest way to avoid pushing them multiple times.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var material = new THREE.MeshLambertMaterial({map:THREE.ImageUtils.loadTexture( 'foo.jpg')});
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Then you use this material as many times as you want, &lt;code&gt;foo.jpg&lt;/code&gt; will be sent
only once to the GPU. For example, let's create many
&lt;a href=&quot;https://github.com/mrdoob/three.js/blob/master/src/extras/geometries/SphereGeometry.js&quot;&gt;spheres&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var mesh = new THREE.Mesh( new THREE.SphereGeometry( 75, 20, 10 ), material );
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;This solution is simple and eleguant but may not be practical with a large code,
like a &lt;a href=&quot;http://learningthreejs.com/blog/categories/tutorial3dgame/&quot;&gt;game&lt;/a&gt;.
In such case, you can use &lt;a href=&quot;https://github.com/jeromeetienne/MicroCache.js&quot;&gt;microcache.js&lt;/a&gt;.
It is a micro library to handle in-memory cache which works in node and browser.&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;So Let's Cache with microcache.js&lt;/h2&gt;

&lt;p&gt;It needs only 3 lines. To install &lt;a href=&quot;https://github.com/jeromeetienne/MicroCache.js&quot;&gt;microcache.js&lt;/a&gt;,
download it and copy this line.&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src=&quot;microcache.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;To instanciate a cache, use the following line.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;renderer._microCache = new MicroCache();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;As you likely noticed, it is attaching the cache to the renderer.
Why do we do that ?
First, it is required to support multiple renderers on the same page, each with it own cache.
Additionnaly if you stop using a renderer, the cache will be automatically dropped
by javascript &lt;a href=&quot;http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)&quot;&gt;garbage collector&lt;/a&gt;.
Two nice features.
Now lets create a texture and cache it.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var texture = renderer._microCache.getSet('heavy', THREE.ImageUtils.loadTexture('foo.png'));
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;This is it. It is &lt;em&gt;as simple as that&lt;/em&gt;.
Now maybe you wonder &quot;yeah but how do i know what need to be cached&quot;...
I completly agree, it is always nice to get diagnostics from the system when
optimizing performance.&lt;/p&gt;

&lt;h2&gt;Now Let's Diagnose&lt;/h2&gt;

&lt;p&gt;&lt;img class='right ' src='http://learningthreejs.com/data/performance-tip-caching-material/webgl-inspector-texture.png' width='' height='' alt='Example' title='Example'&gt;&lt;/p&gt;

&lt;p&gt;You can check what is pushed to the GPU with
&lt;a href=&quot;http://benvanik.github.com/WebGL-Inspector/&quot;&gt;WebGL inspector&lt;/a&gt;.
It is a firebug-like to &quot;debug, diagnose, and explore WebGL scenes&quot;.
You can see the texture tabs on the right. If you spot
duplicates in there, you found rooms for optimization :)
You can embed it in your own page application with a single line.&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src=&quot;https://raw.github.com/benvanik/WebGL-Inspector/master/core/embed.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;That's All Folks&lt;/h2&gt;

&lt;p&gt;As Terje Mathisen said, &quot;All programming is an exercise in caching.&quot;
Caching is a efficient way to optimize your code.
It is simple with &lt;a href=&quot;https://github.com/jeromeetienne/MicroCache.js&quot;&gt;microcache.js&lt;/a&gt;.
The code is available on github &lt;a href=&quot;https://github.com/jeromeetienne/MicroCache.js&quot;&gt;here&lt;/a&gt; under MIT license.
If you hit bugs, fill issues on github. Feel free to fork, modify and have fun with it :)&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Let's Make a 3D Game: Map Editor</title>
    <link href="http://learningthreejs.com/blog/2011/09/14/lets-make-a-3D-game-map-editor/"/>
    <updated>2011-09-14T19:07:00+02:00</updated>
    <id>http://learningthreejs.com/blog/2011/09/14/lets-make-a-3D-game-map-editor</id>
    <content type="html">&lt;p&gt;This is a new article of the &quot;Let's Make a 3D Game&quot; &lt;a href=&quot;http://learningthreejs.com/blog/categories/tutorial3dgame/&quot;&gt;series&lt;/a&gt;.
In the previous one, we focused
on &lt;a href=&quot;http://learningthreejs.com/blog/2011/09/12/lets-Make-a-3D-game-keyboard/&quot;&gt;keyboard&lt;/a&gt;. We will
focus on &lt;em&gt;map editor&lt;/em&gt; for this one.
In most games, the player moves around a map, sometime they are
called &lt;a href=&quot;http://en.wikipedia.org/wiki/Level_(video_gaming)&quot;&gt;levels&lt;/a&gt;.
&lt;em&gt;Maps&lt;/em&gt; are a key part of a game. They describes the world the player lives in,
its rules, its limits, its geography.
Additionnaly when a player completes a map, he
goes in another better/harder map. It gives a sense
progression which is fun. Players like fun things :)&lt;/p&gt;

&lt;h2&gt;So let's make a map editor&lt;/h2&gt;

&lt;p&gt;&lt;img class='right ' src='http://learningthreejs.com/data/lets_make_a_game_map_editor/images/200px-Voxels.svg.png' width='' height='' alt='Example' title='Example'&gt;&lt;/p&gt;

&lt;p&gt;So i searched for a way to do map for our &lt;em&gt;marble game&lt;/em&gt;.
I wanted something &lt;strong&gt;very reusable and hackable&lt;/strong&gt;,
something you could easily use in your own games.
I picked &lt;a href=&quot;http://en.wikipedia.org/wiki/Voxel&quot;&gt;voxels&lt;/a&gt;.
The illustration from &lt;a href=&quot;http://en.wikipedia.org/wiki/File:Voxels.svg&quot;&gt;wikipedia&lt;/a&gt;
on the right, may help understanding.
They are easy to code, simple to understand, yet efficient and flexible.
On top of that, one of &lt;a href=&quot;https://github.com/mrdoob/three.js/tree/master/examples&quot;&gt;three.js examples&lt;/a&gt; is a
&lt;a href=&quot;http://mrdoob.github.com/three.js/examples/webgl_interactive_voxelpainter.html&quot;&gt;voxel painter&lt;/a&gt;
in WebGL. So most of the work was already done for us!&lt;/p&gt;

&lt;p&gt;Only two features were missing to make it a &lt;a href=&quot;http://en.wikipedia.org/wiki/Level_editor&quot;&gt;map editor&lt;/a&gt;.
&lt;strong&gt;First&lt;/strong&gt;, we need to load and save those maps.
Thus we can edit those maps, and tune them until to get a good &lt;a href=&quot;http://en.wikipedia.org/wiki/Gameplay&quot;&gt;gameplay&lt;/a&gt;.
&lt;strong&gt;Second&lt;/strong&gt;, the map must be composed of various type of cubes.
Different type of cubes will have different purposes in the game. e.g. one cube
may be wood or be water, one may make your explode on contact, one may
make you teleport, anything you want.
So i did those modifications and came up with
this &lt;a href=&quot;http://jeromeetienne.github.com/marbleGame/editor&quot;&gt;editor&lt;/a&gt;.&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;Now Let's Use This Editor&lt;/h2&gt;

&lt;p&gt;&lt;img class='right ' src='http://learningthreejs.com/data/lets_make_a_game_map_editor/images/webgl-rocks.png' width='' height='' alt='Example' title='Example'&gt;&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;http://jeromeetienne.github.com/marbleGame/editor&quot;&gt;editor&lt;/a&gt;
got an inline help on top. So it should be rather simple.
Once you are done, you save the map, the editor
will open a window containing a string
describing the saved data. Just copy this data in a file.
To load it back, you just have to drag/drop this file on the
editor window. It is as simple as that.&lt;/p&gt;

&lt;h2&gt;How To Use Saved Maps&lt;/h2&gt;

&lt;p&gt;You load the file you saved into your javascript.
Maps are stored in &lt;a href=&quot;http://en.wikipedia.org/wiki/JSON&quot;&gt;JSON&lt;/a&gt;. It is a data format
which fits well with javascript.
&quot;Everything should be made as simple as possible, but no simpler&quot;
as a &lt;a href=&quot;http://en.wikipedia.org/wiki/Albert_Einstein&quot;&gt;cool guy&lt;/a&gt; said.
So following the &lt;a href=&quot;http://en.wikipedia.org/wiki/Occam%27s_razor&quot;&gt;occam razor&lt;/a&gt;,
this format is just
an &lt;a href=&quot;https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array&quot;&gt;Array&lt;/a&gt; with
each element is one &lt;a href=&quot;https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object&quot;&gt;Object&lt;/a&gt;
representing a voxel.
The object properties are: &lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt;, &lt;code&gt;z&lt;/code&gt;being the
coordinates of this voxel, and &lt;code&gt;t&lt;/code&gt; being its type.&lt;/p&gt;

&lt;h2&gt;Progress&lt;/h2&gt;

&lt;p&gt;Yesterday, i started coding &lt;a href=&quot;http://jeromeetienne.github.com/marbleGame&quot;&gt;early visuals&lt;/a&gt;
for the game. Ok it takes some imaginations to see where it will goes. But it
will improve i promise :)&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Let's Make a 3D Game: Keyboard</title>
    <link href="http://learningthreejs.com/blog/2011/09/12/lets-Make-a-3D-game-keyboard/"/>
    <updated>2011-09-12T17:31:00+02:00</updated>
    <id>http://learningthreejs.com/blog/2011/09/12/lets-Make-a-3D-game-keyboard</id>
    <content type="html">&lt;p&gt;This post is the first of a series &lt;strong&gt;Let's Make a 3d game&lt;/strong&gt;.
The &lt;a href=&quot;http://learningthreejs.com/blog/categories/tutorial3dgame/&quot;&gt;series&lt;/a&gt; will walk you down the path of
game developement.
It will describe the various parts of a web game: input handling, map generation,
collision, physics, sounds, graphics etc...
Obviously we will glue them to make an actual game. Quite a bit of work
but im super excited !&lt;/p&gt;

&lt;p&gt;It will be a &lt;a href=&quot;http://en.wikipedia.org/wiki/Marble_Madness&quot;&gt;marble&lt;/a&gt;
game. Not sure which kind yet, but they are
&lt;a href=&quot;http://www.youtube.com/results?search_query=marble+video+game&quot;&gt;many&lt;/a&gt;.
I did &lt;a href=&quot;http://pacmaze.com&quot;&gt;pacmaze&lt;/a&gt;, a pacman in 3D  and &lt;a href=&quot;http://buddymaze.com&quot;&gt;buddymaze&lt;/a&gt;,
a multi-player first personn shooter. But this one gonna be from scratch, thus we will
discover things as together :)&lt;/p&gt;

&lt;p&gt;We will try to code each part of the game to be as reusable as possible.
The first part will be the &lt;strong&gt;keyboard handling&lt;/strong&gt;. It isnt the hardest, nor the most important, but it is
super simple. Perfect to get us started.&lt;/p&gt;

&lt;h2&gt;Let's get started&lt;/h2&gt;

&lt;p&gt;In a game, a keyboard handler is a bit special. Usually this is done with events
, e.g. &lt;a href=&quot;http://api.jquery.com/bind/&quot;&gt;jQuery.bind()&lt;/a&gt;
or &lt;a href=&quot;https://github.com/jeresig/jquery.hotkeys&quot;&gt;hotkeys&lt;/a&gt;.
But we are doing a game and all games revolve around a &lt;a href=&quot;http://en.wikipedia.org/wiki/Game_programming#Game_structure&quot;&gt;game loop&lt;/a&gt;.
So the keyboard must be queryable at any time during this loop, as opposed
to &lt;a href=&quot;http://en.wikipedia.org/wiki/Event-driven_architecture&quot;&gt;event-driven&lt;/a&gt;.
Our code should keep tracks of which key and which modifier is pressed.
Let's call it &lt;em&gt;KeyboardState&lt;/em&gt;.&lt;/p&gt;

&lt;h2&gt;Let's include the script&lt;/h2&gt;

&lt;p&gt;You download it from &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.KeyboardState.js&quot;&gt;here&lt;/a&gt; and include
it in your page like this&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src='THREEx.KeyboardState.js'&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;How to use it ?&lt;/h2&gt;

&lt;p&gt;Now that the script is included, create a &lt;code&gt;keyboard&lt;/code&gt; variable like this.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var keyboard = new THREEx.KeyboardState();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;After that you can query the current status of the keyboard with &lt;code&gt;.pressed(&quot;W&quot;)&lt;/code&gt;. For
example if you want shift+H to display help, do the following.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;if( keyboard.pressed(&quot;shift+H&quot;) )     displayHelp();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;If you ever want to stop listening to the keyboard, just use this line&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;keyboard.destroy()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;For more details on &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.KeyboardState.js&quot;&gt;THREEx.KeyboardState&lt;/a&gt;,
see its &lt;a href=&quot;http://learningthreejs.com/data/THREEx/docs/THREEx.KeyboardState.html&quot;&gt;annoted source&lt;/a&gt;.
We have seen it is quite simple to use.
Ok now we got the keyboard handling for our game. Nice but it seems a bit virtual for now.
But i think the game will become more concret when we gonna have stuff moving on the screen.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Screenshot in Javascript</title>
    <link href="http://learningthreejs.com/blog/2011/09/03/screenshot-in-javascript/"/>
    <updated>2011-09-03T10:01:00+02:00</updated>
    <id>http://learningthreejs.com/blog/2011/09/03/screenshot-in-javascript</id>
    <content type="html">&lt;p&gt;Sometime it would be cool if you could take a screenshot of your demo to share with your friends.
This post will explain how to do that single a single line.
Additionnaly, &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.screenshot.js&quot;&gt;THREEx.screenshot&lt;/a&gt; helper is provided at the end
if you want to add printscreen key in your demos without hasles.&lt;/p&gt;

&lt;h2&gt;Let's get started&lt;/h2&gt;

&lt;p&gt;So as usual you got a &lt;code&gt;renderer&lt;/code&gt; variable to render your 3D scene. This renderer
contains a &lt;code&gt;domElement&lt;/code&gt; property.
It is a &lt;a href=&quot;http://en.wikipedia.org/wiki/Document_Object_Model&quot;&gt;DOM element&lt;/a&gt; on which it renders,
who would have guessed ?
We will use the &lt;code&gt;.toDataURL()&lt;/code&gt;
&lt;a href=&quot;http://www.w3.org/TR/html5/the-canvas-element.html#dom-canvas-todataurl&quot;&gt;method&lt;/a&gt;
on this element to get the screenshot.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var dataUrl = renderer.domElement.toDataURL(&quot;image/png&quot;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;!-- more --&gt;


&lt;p&gt;A single line and you are &lt;strong&gt;done&lt;/strong&gt;! not too hard hey ?
This line will return a url of the screenshot image in
png format.
This url is a &lt;a href=&quot;http://en.wikipedia.org/wiki/Data_URI_scheme&quot;&gt;data url&lt;/a&gt;, a special url which encode
the content in base64. It looks like that &lt;em&gt;data:image/png;base64,iVBORw0KGgo&lt;/em&gt; ...
Not too readable but quite usefull :)&lt;/p&gt;

&lt;p&gt;Btw have you spotted he &lt;code&gt;image/png&lt;/code&gt; parameter ? It is the mimetype of the image we will get. If you want
a &lt;a href=&quot;http://en.wikipedia.org/wiki/JPEG&quot;&gt;jpeg&lt;/a&gt;, just put &lt;code&gt;image/jpeg&lt;/code&gt; instead.&lt;/p&gt;

&lt;h2&gt;WebGLRenderer special case&lt;/h2&gt;

&lt;p&gt;If your scene is renderered with WebGL, you should declare it like that.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var renderer    = new THREE.WebGLRenderer({
    preserveDrawingBuffer   : true  // required to support .toDataURL()
});
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Notice the option &lt;code&gt;preserveDrawingBuffer&lt;/code&gt; ? It is &lt;code&gt;WebGLRenderer&lt;/code&gt; specific.
This is required to support &lt;code&gt;.toDataURL()&lt;/code&gt; as explained in the &lt;a href=&quot;http://www.khronos.org/registry/webgl/specs/latest/#2.2&quot;&gt;spec&lt;/a&gt;.
Other &lt;a href=&quot;https://github.com/mrdoob/three.js/tree/master/src/renderers&quot;&gt;renderers&lt;/a&gt; dont need it.&lt;/p&gt;

&lt;h2&gt;THREEx helper to make it even simpler&lt;/h2&gt;

&lt;p&gt;I wrote &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.screenshot.js&quot;&gt;THREEx.screenshot&lt;/a&gt;, a THREEx helper to
automatize the process and makes it as simple as possible.
You download it from &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.screenshot.js&quot;&gt;here&lt;/a&gt; and include
it in your page like this&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script type=&quot;text/javascript&quot; src=&quot;THREEx.screenshot.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Would it be cool if got your own &lt;a href=&quot;http://en.wikipedia.org/wiki/Print_screen&quot;&gt;printscreen&lt;/a&gt;
key for your 3D ? The following line will do exactly that.
Everytime you press &lt;em&gt;p&lt;/em&gt;, it does a screenshot of the renderer, and open a window containing it.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;THREEx.Screenshot.bindKey(renderer);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;Note the &lt;a href=&quot;http://en.wikipedia.org/wiki/Aspect_ratio_(image)&quot;&gt;aspect&lt;/a&gt; of the original image is preserved.
The default callback behavior is to open a window containing the screenshot, so be carefull it may be
stopped by popup blockers.
It is possible to customize the default behaviors thru options.
For more details, see the &lt;a href=&quot;http://learningthreejs.com/data/THREEx/docs/THREEx.screenshot.html&quot;&gt;annoted source&lt;/a&gt; of
&lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.screenshot.js&quot;&gt;THREEx.screenshot&lt;/a&gt;.&lt;/p&gt;
</content>
  </entry>
  
  <entry>
    <title>Window Resize For Your Demos</title>
    <link href="http://learningthreejs.com/blog/2011/08/30/window-resize-for-your-demos/"/>
    <updated>2011-08-30T11:24:00+02:00</updated>
    <id>http://learningthreejs.com/blog/2011/08/30/window-resize-for-your-demos</id>
    <content type="html">&lt;p&gt;It is cool when you look at a demo and it is resized automatically
when you change the dimension of the browser's window. To switch it fullscreen
or such.
&lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.WindowResize.js&quot;&gt;THREEx.WindowResize&lt;/a&gt; is an little piece of code.
It helps you do exactly that on your own demos in a single line.&lt;/p&gt;

&lt;h2&gt;Let's include the script&lt;/h2&gt;

&lt;p&gt;You download it from &lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.WindowResize.js&quot;&gt;here&lt;/a&gt; and include
it in your page like this&lt;/p&gt;

&lt;p&gt;```html&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script src='THREEx.WindowResize.js'&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;!-- more --&gt;


&lt;h2&gt;Let's use it&lt;/h2&gt;

&lt;p&gt;Now that the script is included, simply call the following line, and you are done!
Your renderer will follow the window size.&lt;/p&gt;

&lt;p&gt;```javascript&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;THREEx.WindowResize(renderer, camera);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;As usual you got a &lt;code&gt;renderer&lt;/code&gt; and a &lt;code&gt;camera&lt;/code&gt; variable, just pass
them to the function and they will be updated on window resize.&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;For more details, see the &lt;a href=&quot;http://learningthreejs.com/data/THREEx/docs/THREEx.WindowResize.html&quot;&gt;annoted source&lt;/a&gt; of
&lt;a href=&quot;http://learningthreejs.com/data/THREEx/THREEx.WindowResize.js&quot;&gt;THREEx.WindowResize&lt;/a&gt;.&lt;/p&gt;
</content>
  </entry>
  
</feed>
